"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const s=require("react/jsx-runtime"),e=require("react"),C=require("../../utilities/functions.cjs.js"),ee=require("lucide-react"),I=require("@floating-ui/react"),de=require("nanoid"),fe=require("../toaster/utils.cjs.js"),l=require("./component-style.cjs.js"),Z=require("./utils.cjs.js"),pe=require("../../utilities/hooks.cjs.js"),me=require("../badge/badge.cjs.js"),xe=require("../loader/loader.cjs.js"),ie=e.createContext({}),te=()=>e.useContext(ie),se=e.forwardRef(({children:n,icon:u=null,placeholder:i="Select an option",optionIcon:V=null,render:d,label:f,className:E,...k},p)=>{const{sizeValue:g,getReferenceProps:D,getValues:v,selectId:R,refs:F,isOpen:z,multiple:t,combobox:L,setSelected:T,onChange:M,isControlled:q,disabled:r,by:w}=te(),G={sm:"xs",md:"sm",lg:"md"}[g],K=e.useCallback(()=>{if(u)return u;const a="text-field-placeholder "+l.disabledClassNames.icon;return L?s.jsx(ee.ChevronsUpDown,{className:a}):s.jsx(ee.ChevronDown,{className:a})},[u]),$=e.useCallback(()=>{const a=v();if(!a)return null;if(t)return a.map((y,o)=>s.jsx(me.default,{className:"cursor-default",icon:V,type:"rounded",size:G,onMouseDown:O(y),label:typeof d=="function"?d(y):y.toString(),closable:!0,disabled:r},o));let j=typeof a=="string"?a:"";if(typeof d=="function"&&(j=d(a)),typeof n=="function"&&typeof d!="function"){const y={value:a,...t?{onClose:O(a)}:{}};j=n(y)}return(e.isValidElement(n)||typeof n=="string")&&typeof d!="function"&&(j=n),s.jsx("span",{className:C.cn("truncate",l.sizeClassNames[g].displaySelected,l.disabledClassNames.text),children:j})},[v,r]),O=a=>j=>{j?.preventDefault(),j?.stopPropagation();const y=[...v()??[]],o=y.findIndex(c=>c!==null&&a!==null&&typeof c=="object"?c[w]===a[w]:c===a);o!==-1&&(y.splice(o,1),q||T(y),typeof M=="function"&&M(y))};return s.jsxs("div",{className:"w-full flex flex-col items-start gap-1.5 [&_*]:box-border box-border",children:[!!f&&s.jsx("label",{className:C.cn(l.sizeClassNames[g]?.label,"text-field-label"),htmlFor:R,children:f}),s.jsxs("button",{id:R,ref:fe.mergeRefs(F.setReference,p),className:C.cn("flex items-center justify-between w-full box-border transition-[outline,background-color,color,box-shadow] duration-200 bg-white","outline outline-1 outline-field-border border-none cursor-pointer",!z&&"focus:ring-2 focus:ring-offset-2 focus:outline-focus-border focus:ring-focus [&:hover:not(:focus):not(:disabled)]:outline-border-strong",l.sizeClassNames[g].selectButton,t&&l.sizeClassNames[g].multiSelect,l.disabledClassNames.selectButton,E),tabIndex:0,disabled:r,...k,...D(),children:[s.jsxs("div",{className:C.cn("flex-1 grid items-center justify-start gap-1.5 overflow-hidden",v()&&"flex flex-wrap"),children:[$(),(t?!v()?.length:!v())&&s.jsx("div",{className:C.cn("[grid-area:1/1/2/3] text-field-input px-1",l.sizeClassNames[g].displaySelected,l.disabledClassNames.text),children:i})]}),s.jsx("div",{className:C.cn("flex items-center [&>svg]:shrink-0",l.sizeClassNames[g].icon),children:K()})]})]})});function W({label:n,children:u,className:i,...V}){const{index:d,totalGroups:f}=V,{sizeValue:E}=te(),k={sm:"text-xs",md:"text-xs",lg:"text-sm"};return s.jsxs(e.Fragment,{children:[s.jsxs("div",{className:"flex flex-col",role:"group","aria-label":n,children:[s.jsx("div",{className:C.cn("p-2 font-normal text-text-tertiary",k[E],i),id:`group-${n?.toLowerCase().replace(/\s+/g,"-")}`,children:n}),s.jsx("div",{className:"flex flex-col",role:"presentation","aria-labelledby":`group-${n?.toLowerCase().replace(/\s+/g,"-")}`,children:u})]}),d<f&&!!(u&&e.Children.count(u)>0)&&s.jsx("hr",{className:C.cn(l.optionGroupDividerClassNames,l.optionGroupDividerSizeClassNames[E])})]})}function ne({children:n,className:u}){const{isOpen:i,context:V,refs:d,combobox:f,floatingStyles:E,getFloatingProps:k,sizeValue:p,setSearchKeyword:g,setActiveIndex:D,setSelectedIndex:v,value:R,selected:F,getValues:z,searchKeyword:t,listContentRef:L,by:T,searchPlaceholder:M,activeIndex:q,searchFn:r,debounceDelay:w}=te(),G=e.useMemo(()=>{const o=z();let c=-1;if(o){let b=e.Children.toArray(n);b.length>0&&e.isValidElement(b[0])&&b[0].type===W&&(b=e.Children.toArray(n).map(N=>e.isValidElement(N)?e.Children.toArray(N.props.children):[]).flat()),c=b.findIndex(N=>{if(!e.isValidElement(N))return!1;const _=N.props.value;return typeof _=="object"&&typeof o=="object"?_[T]===o[T]:_===o})}return c},[R,F,n,T]);e.useLayoutEffect(()=>{i||(D(G),v(G))},[G,i]),e.useLayoutEffect(()=>{i&&(f&&[-1,null].includes(q)||D(-1))},[t,i]);const K=e.useMemo(()=>{let o=0,c=0;e.Children.forEach(n,h=>{if(e.isValidElement(h)&&h.type===W){let P=!1;if(t&&!r){const A=t.toLowerCase(),Q=(h.props.label?.toLowerCase()||"").includes(A),S=e.Children.toArray(h.props.children).some(H=>e.isValidElement(H)?(Z.getTextContent(H.props.children)?.toLowerCase()).includes(A):!1);P=Q||S}else P=!0;P&&o++}}),c=Math.max(0,o-1);let b=0,N=0;const _=h=>{if(!e.isValidElement(h))return null;if(h.type===W){let P=!1;if(t&&!r){const S=t.toLowerCase();P=(h.props.label?.toLowerCase()||"").includes(S)}const A=e.Children.map(h.props.children,S=>{if(!e.isValidElement(S))return null;if(P){const U={...S.props,index:b++};return e.cloneElement(S,U)}if(t&&!r){const U=Z.getTextContent(S.props.children)?.toLowerCase(),J=t.toLowerCase();if(!U?.includes(J))return null}const H={...S.props,index:b++};return e.cloneElement(S,H)});if(!A?.some(S=>S!==null))return null;const Q={...h.props,children:A,index:N,totalGroups:c};return N++,e.cloneElement(h,Q)}if(t&&!r){const P=Z.getTextContent(h.props?.children)?.toLowerCase(),A=t.toLowerCase();if(!P?.includes(A))return null}return e.cloneElement(h,{...h.props,index:b++})};return e.Children.map(n,_)},[t,R,F,n,r]),$=e.Children.count(K);e.useEffect(()=>{L.current=[];let o=e.Children.toArray(n);o&&e.isValidElement(o[0])&&o[0].type===W&&(o=e.Children.toArray(o).map(c=>e.isValidElement(c)?c.props.children:null).filter(Boolean)),e.Children.forEach(o,c=>{if(!e.isValidElement(c))return;const b=Z.getTextContent(c.props?.children)?.toLowerCase();if(t&&!r){const N=t.toLowerCase();if(!b?.includes(N))return}L.current.push(b)})},[t,r]);const[O,a]=e.useState(!1),j=e.useCallback(async()=>{if(!(!r||typeof r!="function"||O)){a(!0);try{await r(t)}catch(o){console.error(o)}finally{a(!1)}}},[t]),y=pe.useDebouncedCallback(j,w);return e.useEffect(()=>{typeof r=="function"&&y()},[y]),s.jsx(s.Fragment,{children:i&&s.jsx(s.Fragment,{children:s.jsx(I.FloatingFocusManager,{context:V,modal:!1,visuallyHiddenDismiss:!0,children:s.jsxs("div",{ref:d.setFloating,className:C.cn("box-border [&_*]:box-border w-full bg-white outline-none shadow-lg outline outline-1 outline-border-subtle",f&&"grid grid-cols-1 grid-rows-[auto_1fr] divide-y divide-x-0 divide-solid divide-border-subtle",l.sizeClassNames[p].dropdown,!f&&"h-auto",f?"overflow-hidden":"overflow-y-auto overflow-x-hidden",u),style:{...E,zIndex:1},...k(),children:[f&&s.jsxs("div",{className:C.cn(l.sizeClassNames[p].searchbarWrapper),children:[O?s.jsx(xe.Loader,{className:l.sizeClassNames[p].searchbarIcon}):s.jsx(ee.Search,{className:C.cn("text-icon-secondary shrink-0",l.sizeClassNames[p].searchbarIcon)}),s.jsx("input",{className:C.cn("px-1 w-full placeholder:text-field-placeholder border-0 focus:outline-none focus:shadow-none",l.sizeClassNames[p].searchbar),type:"search",name:"keyword",placeholder:M,onChange:o=>g(o.target.value),value:t,autoComplete:"off"})]}),s.jsxs("div",{className:C.cn("overflow-y-auto overflow-x-hidden",!f&&"w-full h-full",l.sizeClassNames[p].dropdownItemsWrapper),children:[!!$&&K,!$&&s.jsx("div",{className:C.cn("p-2 text-center font-medium text-field-placeholder",l.selectItemClassNames[p]),children:"No items found"})]})]})})})})}function oe({children:n,root:u,id:i}){return s.jsx(I.FloatingPortal,{id:i,root:u,children:n})}function re({value:n,selected:u,children:i,className:V,...d}){const{sizeValue:f,getItemProps:E,onKeyDownItem:k,onClickItem:p,activeIndex:g,selectedIndex:D,updateListRef:v,getValues:R,by:F,multiple:z}=te(),{index:t}=d,L=e.useRef(t),T={sm:"size-4",md:"size-4",lg:"size-5"},M=e.useMemo(()=>{if(!z)return!1;const r=R();return r?r.some(w=>w!==null&&n!==null&&typeof w=="object"?w[F]===n[F]:w===n):!1},[n,R]),q=e.useMemo(()=>typeof u=="boolean"?u:z?M:t===D,[M,D,u]);return s.jsxs("div",{className:C.cn("w-full flex items-center justify-between text-text-primary hover:bg-button-tertiary-hover rounded-md transition-all duration-150 cursor-pointer focus:outline-none focus-within:outline-none outline-none",l.selectItemClassNames[f],t===g&&"bg-button-tertiary-hover",V),ref:r=>{v(t,r)},role:"option",tabIndex:t===g?0:-1,"aria-selected":q&&t===g,...E({onClick(){p(L.current,n)},onKeyDown(r){k(r,L.current,n)}}),children:[s.jsx("span",{className:"w-full truncate",children:i}),q&&s.jsx(ee.CheckIcon,{className:C.cn("text-icon-on-color-disabled",T[f])})]})}const ae=({id:n,size:u="md",value:i,defaultValue:V,onChange:d,by:f="id",children:E,multiple:k=!1,combobox:p=!1,disabled:g=!1,searchPlaceholder:D="Search...",searchFn:v,debounceDelay:R=500})=>{const F=e.useMemo(()=>n||`select-${de.nanoid()}`,[n]),z=e.useMemo(()=>typeof i<"u",[i]),[t,L]=e.useState(V),[T,M]=e.useState(""),q=e.useCallback(()=>z?i:t,[z,i,t]),[r,w]=e.useState(!1),[G,K]=e.useState(null),[$,O]=e.useState(null),a={sm:p?256:172,md:p?256:216,lg:p?256:216},{refs:j,floatingStyles:y,context:o}=I.useFloating({strategy:"fixed",placement:"bottom-start",open:r,onOpenChange:w,whileElementsMounted:I.autoUpdate,middleware:[I.offset(5),I.flip({padding:10}),I.size({apply({rects:m,elements:x,availableHeight:B}){Object.assign(x.floating.style,{maxHeight:`min(${B}px, ${a[u]}px)`,maxWidth:`${m.reference.width}px`})},padding:10})]}),c=e.useRef([]),b=e.useRef([]),N=e.useRef(!1),_=I.useClick(o,{event:"mousedown"}),h=I.useDismiss(o),P=I.useRole(o,{role:"listbox"}),A=I.useListNavigation(o,{listRef:c,activeIndex:G,selectedIndex:$,onNavigate:K,loop:!0}),X=I.useTypeahead(o,{listRef:b,activeIndex:G,selectedIndex:$,onMatch:r?K:O,onTypingChange(m){N.current=m}}),{getReferenceProps:Q,getFloatingProps:S,getItemProps:H}=I.useInteractions([h,P,A,_,...p?[]:[X]]),U=(m,x)=>{const B=[...q()??[]];B.findIndex(Y=>Y!==null&&x!==null&&typeof Y=="object"?Y[f]===x[f]:Y===x)===-1&&(B.push(x),z||L(B),O(m),j.reference.current.focus(),w(!1),M(""),typeof d=="function"&&d(B))},J=(m,x)=>{if(k)return U(m,x);O(m),z||L(x),j.reference.current.focus(),w(!1),M(""),typeof d=="function"&&d(x)},le=e.useCallback((m,x)=>{c.current[m]=x},[]),ce=(m,x)=>{J(m,x)},ue=(m,x,B)=>{m.key==="Enter"&&(m.preventDefault(),J(x,B)),m.key===" "&&!N.current&&(m.preventDefault(),J(x,B))};return s.jsx(ie.Provider,{value:{selectedIndex:$,setSelectedIndex:O,activeIndex:G,setActiveIndex:K,selected:t,setSelected:L,handleSelect:J,combobox:p,sizeValue:u,multiple:k,onChange:d,isTypingRef:N,getItemProps:H,onClickItem:ce,onKeyDownItem:ue,getValues:q,selectId:F,getReferenceProps:Q,isOpen:r,value:i,updateListRef:le,refs:j,listContentRef:b,by:f,getFloatingProps:S,floatingStyles:y,context:o,searchKeyword:T,setSearchKeyword:M,disabled:g,isControlled:z,searchPlaceholder:D,searchFn:v,debounceDelay:R},children:E})};ae.displayName="Select";const he=Object.assign(ae,{Portal:oe,Button:se,Options:ne,Option:re,OptionGroup:W});oe.displayName="Select.Portal";se.displayName="Select.Button";ne.displayName="Select.Options";re.displayName="Select.Option";W.displayName="Select.OptionGroup";exports.SelectButton=se;exports.SelectItem=re;exports.SelectOptionGroup=W;exports.SelectOptions=ne;exports.SelectPortal=oe;exports.default=he;
//# sourceMappingURL=select.cjs.js.map
