"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const t=require("react/jsx-runtime"),e=require("react"),C=require("../../utilities/functions.cjs.js"),Q=require("lucide-react"),I=require("@floating-ui/react"),de=require("nanoid"),f=require("./component-style.cjs.js"),Y=require("./utils.cjs.js"),fe=require("../../utilities/hooks.cjs.js"),pe=require("../badge/badge.cjs.js"),me=require("../loader/loader.cjs.js"),ne=e.createContext({}),X=()=>e.useContext(ne);function Z({children:s,icon:c=null,placeholder:i="Select an option",optionIcon:R=null,render:u,label:d,className:E,...M}){const{sizeValue:r,getReferenceProps:V,getValues:y,selectId:A,refs:P,isOpen:D,multiple:h,combobox:o,setSelected:z,onChange:O,isControlled:L,disabled:k,by:a}=X(),g={sm:"xs",md:"sm",lg:"md"}[r],b=e.useCallback(()=>{if(c)return c;const l="text-field-placeholder "+f.disabledClassNames.icon;return o?t.jsx(Q.ChevronsUpDown,{className:l}):t.jsx(Q.ChevronDown,{className:l})},[c]),B=e.useCallback(()=>{const l=y();if(!l)return null;if(h)return l.map((x,q)=>t.jsx(pe.default,{className:"cursor-default",icon:R,type:"rounded",size:g,onMouseDown:F(x),label:typeof u=="function"?u(x):x.toString(),closable:!0,disabled:k},q));let v=typeof l=="string"?l:"";if(typeof u=="function"&&(v=u(l)),typeof s=="function"&&typeof u!="function"){const x={value:l,...h?{onClose:F(l)}:{}};v=s(x)}return(e.isValidElement(s)||typeof s=="string")&&typeof u!="function"&&(v=s),t.jsx("span",{className:C.cn("truncate",f.sizeClassNames[r].displaySelected,f.disabledClassNames.text),children:v})},[y,k]),F=l=>v=>{v?.preventDefault(),v?.stopPropagation();const x=[...y()??[]],q=x.findIndex(n=>n!==null&&l!==null&&typeof n=="object"?n[a]===l[a]:n===l);q!==-1&&(x.splice(q,1),L||z(x),typeof O=="function"&&O(x))};return t.jsxs("div",{className:"w-full flex flex-col items-start gap-1.5 [&_*]:box-border box-border",children:[!!d&&t.jsx("label",{className:C.cn(f.sizeClassNames[r]?.label,"text-field-label"),htmlFor:A,children:d}),t.jsxs("button",{id:A,ref:P.setReference,className:C.cn("flex items-center justify-between w-full box-border transition-[outline,background-color,color,box-shadow] duration-200 bg-white","outline outline-1 outline-field-border border-none cursor-pointer",!D&&"focus:ring-2 focus:ring-offset-2 focus:outline-focus-border focus:ring-focus [&:hover:not(:focus):not(:disabled)]:outline-border-strong",f.sizeClassNames[r].selectButton,h&&f.sizeClassNames[r].multiSelect,f.disabledClassNames.selectButton,E),tabIndex:0,disabled:k,...M,...V(),children:[t.jsxs("div",{className:C.cn("flex-1 grid items-center justify-start gap-1.5 overflow-hidden",y()&&"flex flex-wrap"),children:[B(),(h?!y()?.length:!y())&&t.jsx("div",{className:C.cn("[grid-area:1/1/2/3] text-field-input px-1",f.sizeClassNames[r].displaySelected,f.disabledClassNames.text),children:i})]}),t.jsx("div",{className:C.cn("flex items-center [&>svg]:shrink-0",f.sizeClassNames[r].icon),children:b()})]})]})}function _({label:s,children:c,className:i,...R}){const{index:u,totalGroups:d}=R,{sizeValue:E}=X(),M={sm:"text-xs",md:"text-xs",lg:"text-sm"};return t.jsxs(e.Fragment,{children:[t.jsxs("div",{className:"flex flex-col",role:"group","aria-label":s,children:[t.jsx("div",{className:C.cn("p-2 font-normal text-text-tertiary",M[E],i),id:`group-${s?.toLowerCase().replace(/\s+/g,"-")}`,children:s}),t.jsx("div",{className:"flex flex-col",role:"presentation","aria-labelledby":`group-${s?.toLowerCase().replace(/\s+/g,"-")}`,children:c})]}),u<d&&!!(c&&e.Children.count(c)>0)&&t.jsx("hr",{className:C.cn(f.optionGroupDividerClassNames,f.optionGroupDividerSizeClassNames[E])})]})}function ee({children:s,className:c}){const{isOpen:i,context:R,refs:u,combobox:d,floatingStyles:E,getFloatingProps:M,sizeValue:r,setSearchKeyword:V,setActiveIndex:y,setSelectedIndex:A,value:P,selected:D,getValues:h,searchKeyword:o,listContentRef:z,by:O,searchPlaceholder:L,activeIndex:k,searchFn:a,debounceDelay:g}=X(),b=e.useMemo(()=>{const n=h();let N=-1;if(n){let j=e.Children.toArray(s);j.length>0&&e.isValidElement(j[0])&&j[0].type===_&&(j=e.Children.toArray(s).map(S=>e.isValidElement(S)?e.Children.toArray(S.props.children):[]).flat()),N=j.findIndex(S=>{if(!e.isValidElement(S))return!1;const T=S.props.value;return typeof T=="object"&&typeof n=="object"?T[O]===n[O]:T===n})}return N},[P,D,s,O]);e.useLayoutEffect(()=>{i||(y(b),A(b))},[b,i]),e.useLayoutEffect(()=>{i&&(d&&[-1,null].includes(k)||y(-1))},[o,i]);const B=e.useMemo(()=>{let n=0,N=0;e.Children.forEach(s,w=>{e.isValidElement(w)&&w.type===_&&e.Children.toArray(w.props.children).some($=>{if(!e.isValidElement($))return!1;if(o&&!a){const W=Y.getTextContent($.props.children)?.toLowerCase(),H=o.toLowerCase();return W.includes(H)}return!0})&&n++}),N=Math.max(0,n-1);let j=0,S=0;const T=w=>{if(!e.isValidElement(w))return null;if(w.type===_){const K=e.Children.map(w.props.children,T);if(!K?.some(H=>H!==null))return null;const W={...w.props,children:K,index:S,totalGroups:N};return S++,e.cloneElement(w,W)}if(o&&!a){const K=Y.getTextContent(w.props?.children)?.toLowerCase(),$=o.toLowerCase();if(!K?.includes($))return null}return e.cloneElement(w,{...w.props,index:j++})};return e.Children.map(s,T)},[o,P,D,s,a]),F=e.Children.count(B);e.useEffect(()=>{z.current=[];let n=e.Children.toArray(s);n&&e.isValidElement(n[0])&&n[0].type===_&&(n=e.Children.toArray(n).map(N=>e.isValidElement(N)?N.props.children:null).filter(Boolean)),e.Children.forEach(n,N=>{if(!e.isValidElement(N))return;const j=Y.getTextContent(N.props?.children)?.toLowerCase();if(o&&!a){const S=o.toLowerCase();if(!j?.includes(S))return}z.current.push(j)})},[o,a]);const[l,v]=e.useState(!1),x=e.useCallback(async()=>{if(!(!a||typeof a!="function"||l)){v(!0);try{await a(o)}catch(n){console.error(n)}finally{v(!1)}}},[o]),q=fe.useDebouncedCallback(x,g);return e.useEffect(()=>{typeof a=="function"&&q()},[q]),t.jsx(t.Fragment,{children:i&&t.jsx(t.Fragment,{children:t.jsx(I.FloatingFocusManager,{context:R,modal:!1,children:t.jsxs("div",{ref:u.setFloating,className:C.cn("box-border [&_*]:box-border w-full bg-white outline-none shadow-lg outline outline-1 outline-border-subtle",d&&"grid grid-cols-1 grid-rows-[auto_1fr] divide-y divide-x-0 divide-solid divide-border-subtle",f.sizeClassNames[r].dropdown,!d&&"h-auto",d?"overflow-hidden":"overflow-y-auto overflow-x-hidden",c),style:{...E},...M(),children:[d&&t.jsxs("div",{className:C.cn(f.sizeClassNames[r].searchbarWrapper),children:[l?t.jsx(me.Loader,{className:f.sizeClassNames[r].searchbarIcon}):t.jsx(Q.Search,{className:C.cn("text-icon-secondary shrink-0",f.sizeClassNames[r].searchbarIcon)}),t.jsx("input",{className:C.cn("px-1 w-full placeholder:text-field-placeholder border-0 focus:outline-none focus:shadow-none",f.sizeClassNames[r].searchbar),type:"search",name:"keyword",placeholder:L,onChange:n=>V(n.target.value),value:o,autoComplete:"off"})]}),t.jsxs("div",{className:C.cn("overflow-y-auto overflow-x-hidden",!d&&"w-full h-full",f.sizeClassNames[r].dropdownItemsWrapper),children:[!!F&&B,!F&&t.jsx("div",{className:"p-2 text-center text-base font-medium text-field-placeholder",children:"No items found"})]})]})})})})}function te({children:s,root:c,id:i}){return t.jsx(I.FloatingPortal,{id:i,root:c,children:s})}function se({value:s,selected:c,children:i,className:R,...u}){const{sizeValue:d,getItemProps:E,onKeyDownItem:M,onClickItem:r,activeIndex:V,selectedIndex:y,updateListRef:A,getValues:P,by:D,multiple:h}=X(),{index:o}=u,z=e.useRef(o),O={sm:"py-1.5 px-2 text-xs font-normal",md:"p-2 text-sm font-normal",lg:"p-2 text-base font-normal"},L={sm:"size-4",md:"size-4",lg:"size-5"},k=e.useMemo(()=>{if(!h)return!1;const g=P();return g?g.some(b=>b!==null&&s!==null&&typeof b=="object"?b[D]===s[D]:b===s):!1},[s,P]),a=e.useMemo(()=>typeof c=="boolean"?c:h?k:o===y,[k,y,c]);return t.jsxs("div",{className:C.cn("w-full flex items-center justify-between text-text-primary hover:bg-button-tertiary-hover rounded-md transition-all duration-150 cursor-pointer focus:outline-none focus-within:outline-none outline-none",O[d],o===V&&"bg-button-tertiary-hover",R),ref:g=>{A(o,g)},role:"option",tabIndex:o===V?0:-1,"aria-selected":a&&o===V,...E({onClick(){r(z.current,s)},onKeyDown(g){M(g,z.current,s)}}),children:[t.jsx("span",{className:"w-full truncate",children:i}),a&&t.jsx(Q.CheckIcon,{className:C.cn("text-icon-on-color-disabled",L[d])})]})}const oe=({id:s,size:c="md",value:i,defaultValue:R,onChange:u,by:d="id",children:E,multiple:M=!1,combobox:r=!1,disabled:V=!1,searchPlaceholder:y="Search...",searchFn:A,debounceDelay:P=500})=>{const D=e.useMemo(()=>s||`select-${de.nanoid()}`,[s]),h=e.useMemo(()=>typeof i<"u",[i]),[o,z]=e.useState(R),[O,L]=e.useState(""),k=e.useCallback(()=>h?i:o,[h,i,o]),[a,g]=e.useState(!1),[b,B]=e.useState(null),[F,l]=e.useState(null),v={sm:r?256:172,md:r?256:216,lg:r?256:216},{refs:x,floatingStyles:q,context:n}=I.useFloating({placement:"bottom-start",open:a,onOpenChange:g,whileElementsMounted:I.autoUpdate,middleware:[I.offset(5),I.flip({padding:10}),I.size({apply({rects:p,elements:m,availableHeight:G}){Object.assign(m.floating.style,{maxHeight:`min(${G}px, ${v[c]}px)`,maxWidth:`${p.reference.width}px`})},padding:10})]}),N=e.useRef([]),j=e.useRef([]),S=e.useRef(!1),T=I.useClick(n,{event:"mousedown"}),w=I.useDismiss(n),K=I.useRole(n,{role:"listbox"}),$=I.useListNavigation(n,{listRef:N,activeIndex:b,selectedIndex:F,onNavigate:B,loop:!0}),W=I.useTypeahead(n,{listRef:j,activeIndex:b,selectedIndex:F,onMatch:a?B:l,onTypingChange(p){S.current=p}}),{getReferenceProps:H,getFloatingProps:re,getItemProps:le}=I.useInteractions([w,K,$,T,...r?[]:[W]]),ie=(p,m)=>{const G=[...k()??[]];G.findIndex(J=>J!==null&&m!==null&&typeof J=="object"?J[d]===m[d]:J===m)===-1&&(G.push(m),h||z(G),l(p),x.reference.current.focus(),g(!1),L(""),typeof u=="function"&&u(G))},U=(p,m)=>{if(M)return ie(p,m);l(p),h||z(m),x.reference.current.focus(),g(!1),L(""),typeof u=="function"&&u(m)},ae=e.useCallback((p,m)=>{N.current[p]=m},[]),ce=(p,m)=>{U(p,m)},ue=(p,m,G)=>{p.key==="Enter"&&(p.preventDefault(),U(m,G)),p.key===" "&&!S.current&&(p.preventDefault(),U(m,G))};return t.jsx(ne.Provider,{value:{selectedIndex:F,setSelectedIndex:l,activeIndex:b,setActiveIndex:B,selected:o,setSelected:z,handleSelect:U,combobox:r,sizeValue:c,multiple:M,onChange:u,isTypingRef:S,getItemProps:le,onClickItem:ce,onKeyDownItem:ue,getValues:k,selectId:D,getReferenceProps:H,isOpen:a,value:i,updateListRef:ae,refs:x,listContentRef:j,by:d,getFloatingProps:re,floatingStyles:q,context:n,searchKeyword:O,setSearchKeyword:L,disabled:V,isControlled:h,searchPlaceholder:y,searchFn:A,debounceDelay:P},children:E})};oe.displayName="Select";const xe=Object.assign(oe,{Portal:te,Button:Z,Options:ee,Option:se,OptionGroup:_});te.displayName="Select.Portal";Z.displayName="Select.Button";ee.displayName="Select.Options";se.displayName="Select.Option";_.displayName="Select.OptionGroup";exports.SelectButton=Z;exports.SelectItem=se;exports.SelectOptionGroup=_;exports.SelectOptions=ee;exports.SelectPortal=te;exports.default=xe;
//# sourceMappingURL=select.cjs.js.map
