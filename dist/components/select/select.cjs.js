"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const t=require("react/jsx-runtime"),e=require("react"),h=require("../../utilities/functions.cjs.js"),Q=require("lucide-react"),w=require("@floating-ui/react"),de=require("nanoid"),a=require("./component-style.cjs.js"),Y=require("./utils.cjs.js"),fe=require("../../utilities/hooks.cjs.js"),pe=require("../badge/badge.cjs.js"),me=require("../loader/loader.cjs.js"),ne=e.createContext({}),X=()=>e.useContext(ne);function Z({children:s,icon:u=null,placeholder:c="Select an option",optionIcon:R=null,render:d,label:f,className:k,...E}){const{sizeValue:r,getReferenceProps:V,getValues:y,selectId:A,refs:P,isOpen:D,multiple:C,combobox:o,setSelected:v,onChange:M,isControlled:O,disabled:z,by:l}=X(),j={sm:"xs",md:"sm",lg:"md"}[r],L=e.useCallback(()=>{if(u)return u;const i="text-field-placeholder "+a.disabledClassNames.icon;return o?t.jsx(Q.ChevronsUpDown,{className:i}):t.jsx(Q.ChevronDown,{className:i})},[u]),B=e.useCallback(()=>{const i=y();if(!i)return null;if(C)return i.map((x,q)=>t.jsx(pe.default,{className:"cursor-default",icon:R,type:"rounded",size:j,onMouseDown:F(x),label:typeof d=="function"?d(x):x.toString(),closable:!0,disabled:z},q));let I=typeof i=="string"?i:"";if(typeof d=="function"&&(I=d(i)),typeof s=="function"&&typeof d!="function"){const x={value:i,...C?{onClose:F(i)}:{}};I=s(x)}return(e.isValidElement(s)||typeof s=="string")&&typeof d!="function"&&(I=s),t.jsx("span",{className:h.cn("truncate",a.sizeClassNames[r].displaySelected,a.disabledClassNames.text),children:I})},[y,z]),F=i=>I=>{I?.preventDefault(),I?.stopPropagation();const x=[...y()??[]],q=x.findIndex(n=>n!==null&&i!==null&&typeof n=="object"?n[l]===i[l]:n===i);q!==-1&&(x.splice(q,1),O||v(x),typeof M=="function"&&M(x))};return t.jsxs("div",{className:"w-full flex flex-col items-start gap-1.5 [&_*]:box-border box-border",children:[!!f&&t.jsx("label",{className:h.cn(a.sizeClassNames[r]?.label,"text-field-label"),htmlFor:A,children:f}),t.jsxs("button",{id:A,ref:P.setReference,className:h.cn("flex items-center justify-between w-full box-border transition-[outline,background-color,color,box-shadow] duration-200 bg-white","outline outline-1 outline-field-border border-none cursor-pointer",!D&&"focus:ring-2 focus:ring-offset-2 focus:outline-focus-border focus:ring-focus [&:hover:not(:focus):not(:disabled)]:outline-border-strong",a.sizeClassNames[r].selectButton,C&&a.sizeClassNames[r].multiSelect,a.disabledClassNames.selectButton,k),tabIndex:0,disabled:z,...E,...V(),children:[t.jsxs("div",{className:h.cn("flex-1 grid items-center justify-start gap-1.5 overflow-hidden",y()&&"flex flex-wrap"),children:[B(),(C?!y()?.length:!y())&&t.jsx("div",{className:h.cn("[grid-area:1/1/2/3] text-field-input px-1",a.sizeClassNames[r].displaySelected,a.disabledClassNames.text),children:c})]}),t.jsx("div",{className:h.cn("flex items-center [&>svg]:shrink-0",a.sizeClassNames[r].icon),children:L()})]})]})}function _({label:s,children:u,className:c,...R}){const{index:d,totalGroups:f}=R,{sizeValue:k}=X(),E={sm:"text-xs",md:"text-xs",lg:"text-sm"};return t.jsxs(e.Fragment,{children:[t.jsxs("div",{className:"flex flex-col",role:"group","aria-label":s,children:[t.jsx("div",{className:h.cn("p-2 font-normal text-text-tertiary",E[k],c),id:`group-${s?.toLowerCase().replace(/\s+/g,"-")}`,children:s}),t.jsx("div",{className:"flex flex-col",role:"presentation","aria-labelledby":`group-${s?.toLowerCase().replace(/\s+/g,"-")}`,children:u})]}),d<f&&!!(u&&e.Children.count(u)>0)&&t.jsx("hr",{className:h.cn(a.optionGroupDividerClassNames,a.optionGroupDividerSizeClassNames[k])})]})}function ee({children:s,className:u}){const{isOpen:c,context:R,refs:d,combobox:f,floatingStyles:k,getFloatingProps:E,sizeValue:r,setSearchKeyword:V,setActiveIndex:y,setSelectedIndex:A,value:P,selected:D,getValues:C,searchKeyword:o,listContentRef:v,by:M,searchPlaceholder:O,activeIndex:z,searchFn:l,debounceDelay:j}=X(),L=e.useMemo(()=>{const n=C();let g=-1;if(n){let S=e.Children.toArray(s);S.length>0&&e.isValidElement(S[0])&&S[0].type===_&&(S=e.Children.toArray(s).map(b=>e.isValidElement(b)?e.Children.toArray(b.props.children):[]).flat()),g=S.findIndex(b=>{if(!e.isValidElement(b))return!1;const T=b.props.value;return typeof T=="object"&&typeof n=="object"?T[M]===n[M]:T===n})}return g},[P,D,s,M]);e.useLayoutEffect(()=>{c||(y(L),A(L))},[L,c]),e.useLayoutEffect(()=>{c&&(f&&[-1,null].includes(z)||y(-1))},[o,c]);const B=e.useMemo(()=>{let n=0,g=0;e.Children.forEach(s,N=>{e.isValidElement(N)&&N.type===_&&e.Children.toArray(N.props.children).some($=>{if(!e.isValidElement($))return!1;if(o&&!l){const H=Y.getTextContent($.props.children)?.toLowerCase(),W=o.toLowerCase();return H.includes(W)}return!0})&&n++}),g=Math.max(0,n-1);let S=0,b=0;const T=N=>{if(!e.isValidElement(N))return null;if(N.type===_){const K=e.Children.map(N.props.children,T);if(!K?.some(W=>W!==null))return null;const H={...N.props,children:K,index:b,totalGroups:g};return b++,e.cloneElement(N,H)}if(o&&!l){const K=Y.getTextContent(N.props?.children)?.toLowerCase(),$=o.toLowerCase();if(!K?.includes($))return null}return e.cloneElement(N,{...N.props,index:S++})};return e.Children.map(s,T)},[o,P,D,s,l]),F=e.Children.count(B);e.useEffect(()=>{v.current=[];let n=e.Children.toArray(s);n&&e.isValidElement(n[0])&&n[0].type===_&&(n=e.Children.toArray(n).map(g=>e.isValidElement(g)?g.props.children:null).filter(Boolean)),e.Children.forEach(n,g=>{if(!e.isValidElement(g))return;const S=Y.getTextContent(g.props?.children)?.toLowerCase();if(o&&!l){const b=o.toLowerCase();if(!S?.includes(b))return}v.current.push(S)})},[o,l]);const[i,I]=e.useState(!1),x=e.useCallback(async()=>{if(!(!l||typeof l!="function"||i)){I(!0);try{await l(o)}catch(n){console.error(n)}finally{I(!1)}}},[o]),q=fe.useDebouncedCallback(x,j);return e.useEffect(()=>{typeof l=="function"&&q()},[q]),t.jsx(t.Fragment,{children:c&&t.jsx(t.Fragment,{children:t.jsx(w.FloatingFocusManager,{context:R,modal:!1,visuallyHiddenDismiss:!0,children:t.jsxs("div",{ref:d.setFloating,className:h.cn("box-border [&_*]:box-border w-full bg-white outline-none shadow-lg outline outline-1 outline-border-subtle",f&&"grid grid-cols-1 grid-rows-[auto_1fr] divide-y divide-x-0 divide-solid divide-border-subtle",a.sizeClassNames[r].dropdown,!f&&"h-auto",f?"overflow-hidden":"overflow-y-auto overflow-x-hidden",u),style:{...k,zIndex:1},...E(),children:[f&&t.jsxs("div",{className:h.cn(a.sizeClassNames[r].searchbarWrapper),children:[i?t.jsx(me.Loader,{className:a.sizeClassNames[r].searchbarIcon}):t.jsx(Q.Search,{className:h.cn("text-icon-secondary shrink-0",a.sizeClassNames[r].searchbarIcon)}),t.jsx("input",{className:h.cn("px-1 w-full placeholder:text-field-placeholder border-0 focus:outline-none focus:shadow-none",a.sizeClassNames[r].searchbar),type:"search",name:"keyword",placeholder:O,onChange:n=>V(n.target.value),value:o,autoComplete:"off"})]}),t.jsxs("div",{className:h.cn("overflow-y-auto overflow-x-hidden",!f&&"w-full h-full",a.sizeClassNames[r].dropdownItemsWrapper),children:[!!F&&B,!F&&t.jsx("div",{className:h.cn("p-2 text-center font-medium text-field-placeholder",a.selectItemClassNames[r]),children:"No items found"})]})]})})})})}function te({children:s,root:u,id:c}){return t.jsx(w.FloatingPortal,{id:c,root:u,children:s})}function se({value:s,selected:u,children:c,className:R,...d}){const{sizeValue:f,getItemProps:k,onKeyDownItem:E,onClickItem:r,activeIndex:V,selectedIndex:y,updateListRef:A,getValues:P,by:D,multiple:C}=X(),{index:o}=d,v=e.useRef(o),M={sm:"size-4",md:"size-4",lg:"size-5"},O=e.useMemo(()=>{if(!C)return!1;const l=P();return l?l.some(j=>j!==null&&s!==null&&typeof j=="object"?j[D]===s[D]:j===s):!1},[s,P]),z=e.useMemo(()=>typeof u=="boolean"?u:C?O:o===y,[O,y,u]);return t.jsxs("div",{className:h.cn("w-full flex items-center justify-between text-text-primary hover:bg-button-tertiary-hover rounded-md transition-all duration-150 cursor-pointer focus:outline-none focus-within:outline-none outline-none",a.selectItemClassNames[f],o===V&&"bg-button-tertiary-hover",R),ref:l=>{A(o,l)},role:"option",tabIndex:o===V?0:-1,"aria-selected":z&&o===V,...k({onClick(){r(v.current,s)},onKeyDown(l){E(l,v.current,s)}}),children:[t.jsx("span",{className:"w-full truncate",children:c}),z&&t.jsx(Q.CheckIcon,{className:h.cn("text-icon-on-color-disabled",M[f])})]})}const oe=({id:s,size:u="md",value:c,defaultValue:R,onChange:d,by:f="id",children:k,multiple:E=!1,combobox:r=!1,disabled:V=!1,searchPlaceholder:y="Search...",searchFn:A,debounceDelay:P=500})=>{const D=e.useMemo(()=>s||`select-${de.nanoid()}`,[s]),C=e.useMemo(()=>typeof c<"u",[c]),[o,v]=e.useState(R),[M,O]=e.useState(""),z=e.useCallback(()=>C?c:o,[C,c,o]),[l,j]=e.useState(!1),[L,B]=e.useState(null),[F,i]=e.useState(null),I={sm:r?256:172,md:r?256:216,lg:r?256:216},{refs:x,floatingStyles:q,context:n}=w.useFloating({strategy:"fixed",placement:"bottom-start",open:l,onOpenChange:j,whileElementsMounted:w.autoUpdate,middleware:[w.offset(5),w.flip({padding:10}),w.size({apply({rects:p,elements:m,availableHeight:G}){Object.assign(m.floating.style,{maxHeight:`min(${G}px, ${I[u]}px)`,maxWidth:`${p.reference.width}px`})},padding:10})]}),g=e.useRef([]),S=e.useRef([]),b=e.useRef(!1),T=w.useClick(n,{event:"mousedown"}),N=w.useDismiss(n),K=w.useRole(n,{role:"listbox"}),$=w.useListNavigation(n,{listRef:g,activeIndex:L,selectedIndex:F,onNavigate:B,loop:!0}),H=w.useTypeahead(n,{listRef:S,activeIndex:L,selectedIndex:F,onMatch:l?B:i,onTypingChange(p){b.current=p}}),{getReferenceProps:W,getFloatingProps:re,getItemProps:le}=w.useInteractions([N,K,$,T,...r?[]:[H]]),ie=(p,m)=>{const G=[...z()??[]];G.findIndex(J=>J!==null&&m!==null&&typeof J=="object"?J[f]===m[f]:J===m)===-1&&(G.push(m),C||v(G),i(p),x.reference.current.focus(),j(!1),O(""),typeof d=="function"&&d(G))},U=(p,m)=>{if(E)return ie(p,m);i(p),C||v(m),x.reference.current.focus(),j(!1),O(""),typeof d=="function"&&d(m)},ae=e.useCallback((p,m)=>{g.current[p]=m},[]),ce=(p,m)=>{U(p,m)},ue=(p,m,G)=>{p.key==="Enter"&&(p.preventDefault(),U(m,G)),p.key===" "&&!b.current&&(p.preventDefault(),U(m,G))};return t.jsx(ne.Provider,{value:{selectedIndex:F,setSelectedIndex:i,activeIndex:L,setActiveIndex:B,selected:o,setSelected:v,handleSelect:U,combobox:r,sizeValue:u,multiple:E,onChange:d,isTypingRef:b,getItemProps:le,onClickItem:ce,onKeyDownItem:ue,getValues:z,selectId:D,getReferenceProps:W,isOpen:l,value:c,updateListRef:ae,refs:x,listContentRef:S,by:f,getFloatingProps:re,floatingStyles:q,context:n,searchKeyword:M,setSearchKeyword:O,disabled:V,isControlled:C,searchPlaceholder:y,searchFn:A,debounceDelay:P},children:k})};oe.displayName="Select";const xe=Object.assign(oe,{Portal:te,Button:Z,Options:ee,Option:se,OptionGroup:_});te.displayName="Select.Portal";Z.displayName="Select.Button";ee.displayName="Select.Options";se.displayName="Select.Option";_.displayName="Select.OptionGroup";exports.SelectButton=Z;exports.SelectItem=se;exports.SelectOptionGroup=_;exports.SelectOptions=ee;exports.SelectPortal=te;exports.default=xe;
//# sourceMappingURL=select.cjs.js.map
