{"version":3,"file":"select.es.js","sources":["../../../src/components/select/select.tsx"],"sourcesContent":["import {\n\tuseState,\n\tuseCallback,\n\tuseMemo,\n\tuseRef,\n\tcreateContext,\n\tuseContext,\n\tChildren,\n\tcloneElement,\n\tisValidElement,\n\tuseEffect,\n\tuseLayoutEffect,\n\tFragment,\n\tforwardRef,\n\ttype ReactNode,\n} from 'react';\nimport { cn } from '@/utilities/functions';\nimport { CheckIcon, ChevronDown, ChevronsUpDown, Search } from 'lucide-react';\nimport {\n\tuseFloating,\n\tuseClick,\n\tuseDismiss,\n\tuseRole,\n\tuseListNavigation,\n\tuseInteractions,\n\tFloatingFocusManager,\n\tuseTypeahead,\n\toffset,\n\tflip,\n\tsize,\n\tautoUpdate,\n\tFloatingPortal,\n} from '@floating-ui/react';\nimport { Badge, Loader } from '@/components';\nimport { nanoid } from 'nanoid';\nimport { mergeRefs } from '@/components/toaster/utils';\nimport {\n\tdisabledClassNames,\n\toptionGroupDividerClassNames,\n\toptionGroupDividerSizeClassNames,\n\tselectItemClassNames,\n\tsizeClassNames,\n} from './component-style';\nimport type {\n\tOnClick,\n\tOnKeyDown,\n\tSelectButtonProps,\n\tSelectContextValue,\n\tSelectGetValues,\n\tSelectOptionProps,\n\tSelectOptionsProps,\n\tSelectOptionValue,\n\tSelectPortalProps,\n\tSelectProps,\n\tSelectSizes,\n\tSelectOptionGroupProps,\n} from './select-types';\nimport { getTextContent } from './utils';\nimport { useDebouncedCallback } from '@/utilities/hooks';\n\n// Context to manage the state of the select component.\nconst SelectContext = createContext<SelectContextValue>(\n\t{} as SelectContextValue\n);\nconst useSelectContext = () => useContext( SelectContext );\n\nexport const SelectButton = forwardRef<HTMLButtonElement, SelectButtonProps>( ( {\n\tchildren,\n\ticon = null, // Icon to show in the select button.\n\tplaceholder = 'Select an option', // Placeholder text.\n\toptionIcon = null, // Icon to show in the selected option.\n\trender,\n\tlabel, // Label for the select component.\n\tclassName,\n\t...props\n}: SelectButtonProps, ref ) => {\n\tconst {\n\t\tsizeValue,\n\t\tgetReferenceProps,\n\t\tgetValues,\n\t\tselectId,\n\t\trefs,\n\t\tisOpen,\n\t\tmultiple,\n\t\tcombobox,\n\t\tsetSelected,\n\t\tonChange,\n\t\tisControlled,\n\t\tdisabled,\n\t\tby,\n\t} = useSelectContext();\n\n\tconst badgeSize = {\n\t\tsm: 'xs',\n\t\tmd: 'sm',\n\t\tlg: 'md',\n\t}?.[ sizeValue as SelectSizes ];\n\n\t// Get icon based on the Select component type and user provided icon.\n\tconst getIcon = useCallback( () => {\n\t\tif ( icon ) {\n\t\t\treturn icon;\n\t\t}\n\n\t\tconst iconClassNames =\n\t\t\t'text-field-placeholder ' + disabledClassNames.icon;\n\n\t\treturn combobox ? (\n\t\t\t<ChevronsUpDown className={ iconClassNames } />\n\t\t) : (\n\t\t\t<ChevronDown className={ iconClassNames } />\n\t\t);\n\t}, [ icon ] );\n\n\tconst renderSelected = useCallback( () => {\n\t\tconst selectedValue = getValues();\n\n\t\tif ( ! selectedValue ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif ( multiple ) {\n\t\t\treturn ( selectedValue as SelectOptionValue[] ).map(\n\t\t\t\t( valueItem: SelectOptionValue, index: number ) => (\n\t\t\t\t\t<Badge\n\t\t\t\t\t\tclassName=\"cursor-default\"\n\t\t\t\t\t\ticon={ optionIcon }\n\t\t\t\t\t\ttype=\"rounded\"\n\t\t\t\t\t\tkey={ index }\n\t\t\t\t\t\tsize={ badgeSize as SelectSizes }\n\t\t\t\t\t\tonMouseDown={ handleOnCloseItem( valueItem ) }\n\t\t\t\t\t\tlabel={\n\t\t\t\t\t\t\ttypeof render === 'function'\n\t\t\t\t\t\t\t\t? render( valueItem as SelectOptionValue )\n\t\t\t\t\t\t\t\t: valueItem.toString()\n\t\t\t\t\t\t}\n\t\t\t\t\t\tclosable={ true }\n\t\t\t\t\t\tdisabled={ disabled }\n\t\t\t\t\t/>\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tlet renderValue: ReactNode =\n\t\t\ttypeof selectedValue === 'string' ? selectedValue : '';\n\n\t\tif ( typeof render === 'function' ) {\n\t\t\trenderValue = render( selectedValue as SelectOptionValue );\n\t\t}\n\n\t\tif ( typeof children === 'function' && typeof render !== 'function' ) {\n\t\t\tconst childProps = {\n\t\t\t\tvalue: selectedValue as SelectOptionValue,\n\t\t\t\t...( multiple\n\t\t\t\t\t? {\n\t\t\t\t\t\tonClose: handleOnCloseItem(\n\t\t\t\t\t\t\t\tselectedValue as SelectOptionValue\n\t\t\t\t\t\t),\n\t\t\t\t\t}\n\t\t\t\t\t: {} ),\n\t\t\t};\n\t\t\trenderValue = children( childProps );\n\t\t}\n\n\t\tif (\n\t\t\t( isValidElement( children ) || typeof children === 'string' ) &&\n\t\t\ttypeof render !== 'function'\n\t\t) {\n\t\t\trenderValue = children;\n\t\t}\n\n\t\treturn (\n\t\t\t<span\n\t\t\t\tclassName={ cn(\n\t\t\t\t\t'truncate',\n\t\t\t\t\tsizeClassNames[ sizeValue as SelectSizes ].displaySelected,\n\t\t\t\t\tdisabledClassNames.text\n\t\t\t\t) }\n\t\t\t>\n\t\t\t\t{ renderValue as React.ReactNode }\n\t\t\t</span>\n\t\t);\n\t}, [ getValues, disabled ] );\n\n\tconst handleOnCloseItem =\n\t\t( value: SelectOptionValue ) =>\n\t\t\t( event?: React.MouseEvent<HTMLElement> ) => {\n\t\t\t\tevent?.preventDefault();\n\t\t\t\tevent?.stopPropagation();\n\n\t\t\t\tconst selectedValues = [\n\t\t\t\t\t...( ( getValues() as SelectOptionValue[] ) ?? [] ),\n\t\t\t\t];\n\t\t\t\tconst selectedIndex = selectedValues.findIndex( ( val ) => {\n\t\t\t\t\tif ( val !== null && value !== null && typeof val === 'object' ) {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t( val as Record<string, unknown> )[ by ] ===\n\t\t\t\t\t\t( value as Record<string, unknown> )[ by ]\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\treturn val === value;\n\t\t\t\t} );\n\n\t\t\t\tif ( selectedIndex === -1 ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tselectedValues.splice( selectedIndex, 1 );\n\n\t\t\t\tif ( ! isControlled ) {\n\t\t\t\t\tsetSelected( selectedValues );\n\t\t\t\t}\n\t\t\t\tif ( typeof onChange === 'function' ) {\n\t\t\t\t\tonChange( selectedValues );\n\t\t\t\t}\n\t\t\t};\n\n\treturn (\n\t\t<div className=\"w-full flex flex-col items-start gap-1.5 [&_*]:box-border box-border\">\n\t\t\t{ !! label && (\n\t\t\t\t<label\n\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\tsizeClassNames[ sizeValue as SelectSizes ]?.label,\n\t\t\t\t\t\t'text-field-label'\n\t\t\t\t\t) }\n\t\t\t\t\thtmlFor={ selectId }\n\t\t\t\t>\n\t\t\t\t\t{ label }\n\t\t\t\t</label>\n\t\t\t) }\n\t\t\t<button\n\t\t\t\tid={ selectId }\n\t\t\t\tref={ mergeRefs( refs.setReference, ref ) }\n\t\t\t\tclassName={ cn(\n\t\t\t\t\t'flex items-center justify-between w-full box-border transition-[outline,background-color,color,box-shadow] duration-200 bg-white',\n\t\t\t\t\t'outline outline-1 outline-field-border border-none cursor-pointer',\n\t\t\t\t\t! isOpen &&\n\t\t\t\t\t\t'focus:ring-2 focus:ring-offset-2 focus:outline-focus-border focus:ring-focus [&:hover:not(:focus):not(:disabled)]:outline-border-strong',\n\t\t\t\t\tsizeClassNames[ sizeValue as SelectSizes ].selectButton,\n\t\t\t\t\tmultiple &&\n\t\t\t\t\t\tsizeClassNames[ sizeValue as SelectSizes ].multiSelect,\n\t\t\t\t\tdisabledClassNames.selectButton,\n\t\t\t\t\tclassName\n\t\t\t\t) }\n\t\t\t\ttabIndex={ 0 }\n\t\t\t\tdisabled={ disabled }\n\t\t\t\t{ ...props }\n\t\t\t\t{ ...getReferenceProps() }\n\t\t\t>\n\t\t\t\t{ /* Input and selected item container */ }\n\t\t\t\t<div\n\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t'flex-1 grid items-center justify-start gap-1.5 overflow-hidden',\n\t\t\t\t\t\tgetValues() && 'flex flex-wrap'\n\t\t\t\t\t) }\n\t\t\t\t>\n\t\t\t\t\t{ /* Show Selected item/items (Multi-selector) */ }\n\t\t\t\t\t{ renderSelected() }\n\n\t\t\t\t\t{ /* Placeholder */ }\n\t\t\t\t\t{ ( multiple\n\t\t\t\t\t\t? ! ( getValues() as SelectOptionValue[] )?.length\n\t\t\t\t\t\t: ! getValues() ) && (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t\t'[grid-area:1/1/2/3] text-field-input px-1',\n\t\t\t\t\t\t\t\tsizeClassNames[ sizeValue as SelectSizes ]\n\t\t\t\t\t\t\t\t\t.displaySelected,\n\t\t\t\t\t\t\t\tdisabledClassNames.text\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ placeholder }\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t\t{ /* Suffix Icon */ }\n\t\t\t\t<div\n\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t'flex items-center [&>svg]:shrink-0',\n\t\t\t\t\t\tsizeClassNames[ sizeValue as SelectSizes ].icon\n\t\t\t\t\t) }\n\t\t\t\t>\n\t\t\t\t\t{ getIcon() }\n\t\t\t\t</div>\n\t\t\t</button>\n\t\t</div>\n\t);\n} );\n\nexport function SelectOptionGroup( {\n\tlabel,\n\tchildren,\n\tclassName,\n\t...props\n}: SelectOptionGroupProps ) {\n\tconst { index, totalGroups } = props as {\n\t\tindex: number;\n\t\ttotalGroups: number;\n\t};\n\tconst { sizeValue } = useSelectContext();\n\n\tconst groupClassNames = {\n\t\tsm: 'text-xs',\n\t\tmd: 'text-xs',\n\t\tlg: 'text-sm',\n\t};\n\n\treturn (\n\t\t<Fragment>\n\t\t\t<div className=\"flex flex-col\" role=\"group\" aria-label={ label }>\n\t\t\t\t<div\n\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t'p-2 font-normal text-text-tertiary',\n\t\t\t\t\t\tgroupClassNames[ sizeValue as SelectSizes ],\n\t\t\t\t\t\tclassName\n\t\t\t\t\t) }\n\t\t\t\t\tid={ `group-${ label?.toLowerCase().replace( /\\s+/g, '-' ) }` }\n\t\t\t\t>\n\t\t\t\t\t{ label }\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"flex flex-col\"\n\t\t\t\t\trole=\"presentation\"\n\t\t\t\t\taria-labelledby={ `group-${ label?.toLowerCase().replace( /\\s+/g, '-' ) }` }\n\t\t\t\t>\n\t\t\t\t\t{ children }\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t{ index < totalGroups &&\n\t\t\t\t!! ( children && Children.count( children ) > 0 ) && (\n\t\t\t\t<hr\n\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\toptionGroupDividerClassNames,\n\t\t\t\t\t\toptionGroupDividerSizeClassNames[\n\t\t\t\t\t\t\t\tsizeValue as SelectSizes\n\t\t\t\t\t\t]\n\t\t\t\t\t) }\n\t\t\t\t/>\n\t\t\t) }\n\t\t</Fragment>\n\t);\n}\n\nexport function SelectOptions( {\n\tchildren,\n\tclassName, // Additional class name for the dropdown.\n}: SelectOptionsProps ) {\n\tconst {\n\t\tisOpen,\n\t\tcontext,\n\t\trefs,\n\t\tcombobox,\n\t\tfloatingStyles,\n\t\tgetFloatingProps,\n\t\tsizeValue,\n\t\tsetSearchKeyword,\n\t\tsetActiveIndex,\n\t\tsetSelectedIndex,\n\t\tvalue,\n\t\tselected,\n\t\tgetValues,\n\t\tsearchKeyword,\n\t\tlistContentRef,\n\t\tby,\n\t\tsearchPlaceholder,\n\t\tactiveIndex,\n\t\tsearchFn,\n\t\tdebounceDelay,\n\t} = useSelectContext();\n\n\tconst initialSelectedValueIndex = useMemo( () => {\n\t\tconst currentValue = getValues();\n\t\tlet indexValue = -1;\n\n\t\tif ( currentValue ) {\n\t\t\t// Get all children as an array\n\t\t\tlet allChildren = Children.toArray( children );\n\n\t\t\t// If it's an option group, flatten the children\n\t\t\tif (\n\t\t\t\tallChildren.length > 0 &&\n\t\t\t\tisValidElement( allChildren[ 0 ] ) &&\n\t\t\t\tallChildren[ 0 ].type === SelectOptionGroup\n\t\t\t) {\n\t\t\t\tallChildren = Children.toArray( children )\n\t\t\t\t\t.map( ( group ) =>\n\t\t\t\t\t\tisValidElement( group )\n\t\t\t\t\t\t\t? Children.toArray( group.props.children )\n\t\t\t\t\t\t\t: []\n\t\t\t\t\t)\n\t\t\t\t\t.flat();\n\t\t\t}\n\n\t\t\tindexValue = allChildren.findIndex( ( child: React.ReactNode ) => {\n\t\t\t\tif ( ! isValidElement( child ) ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst childValue = child.props.value;\n\n\t\t\t\tif (\n\t\t\t\t\ttypeof childValue === 'object' &&\n\t\t\t\t\ttypeof currentValue === 'object'\n\t\t\t\t) {\n\t\t\t\t\treturn (\n\t\t\t\t\t\tchildValue[ by ] ===\n\t\t\t\t\t\t( currentValue as Record<string, unknown> )[ by ]\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// For non-object values, do a direct comparison\n\t\t\t\treturn childValue === currentValue;\n\t\t\t} );\n\t\t}\n\n\t\treturn indexValue;\n\t}, [ value, selected, children, by ] );\n\n\t// Initialize active and selected index.\n\tuseLayoutEffect( () => {\n\t\tif ( isOpen ) {\n\t\t\treturn;\n\t\t}\n\t\tsetActiveIndex( initialSelectedValueIndex );\n\t\tsetSelectedIndex( initialSelectedValueIndex );\n\t}, [ initialSelectedValueIndex, isOpen ] );\n\n\t// Reset active index when search keyword changes.\n\tuseLayoutEffect( () => {\n\t\tif ( ! isOpen ) {\n\t\t\treturn;\n\t\t}\n\t\tif ( combobox && [ -1, null ].includes( activeIndex ) ) {\n\t\t\treturn;\n\t\t}\n\t\tsetActiveIndex( -1 );\n\t}, [ searchKeyword, isOpen ] );\n\n\t// Render children based on the search keyword.\n\tconst renderChildren = useMemo( () => {\n\t\t// Track actual visible groups after filtering\n\t\tlet visibleGroups = 0;\n\t\tlet totalGroups = 0;\n\n\t\t// First pass - count total visible groups\n\t\tChildren.forEach( children, ( child ) => {\n\t\t\tif ( isValidElement( child ) && child.type === SelectOptionGroup ) {\n\t\t\t\tlet hasVisibleChildren = false;\n\n\t\t\t\t// If there's a search term and no external search function\n\t\t\t\tif ( searchKeyword && ! searchFn ) {\n\t\t\t\t\tconst searchTerm = searchKeyword.toLowerCase();\n\t\t\t\t\tconst groupLabel = child.props.label?.toLowerCase() || '';\n\n\t\t\t\t\t// Check if group label matches search term\n\t\t\t\t\tconst groupLabelMatches = groupLabel.includes( searchTerm );\n\n\t\t\t\t\t// Check if any child option matches search term\n\t\t\t\t\tconst hasMatchingChildren = Children.toArray(\n\t\t\t\t\t\tchild.props.children\n\t\t\t\t\t).some( ( groupChild ) => {\n\t\t\t\t\t\tif ( ! isValidElement( groupChild ) ) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst textContent = getTextContent(\n\t\t\t\t\t\t\tgroupChild.props.children\n\t\t\t\t\t\t)?.toLowerCase();\n\n\t\t\t\t\t\treturn textContent.includes( searchTerm );\n\t\t\t\t\t} );\n\n\t\t\t\t\t// Show group if either group label matches or any child matches\n\t\t\t\t\thasVisibleChildren = groupLabelMatches || hasMatchingChildren;\n\t\t\t\t} else {\n\t\t\t\t\t// No search term, show all groups\n\t\t\t\t\thasVisibleChildren = true;\n\t\t\t\t}\n\n\t\t\t\tif ( hasVisibleChildren ) {\n\t\t\t\t\tvisibleGroups++;\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\n\t\ttotalGroups = Math.max( 0, visibleGroups - 1 ); // Subtract 1 since we don't need divider after last group\n\t\tlet childIndex = 0;\n\t\tlet groupIndex = 0;\n\n\t\t// Process child to render\n\t\tconst processChild = ( child: React.ReactNode ): React.ReactNode => {\n\t\t\tif ( ! isValidElement( child ) ) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\t// Handle option groups\n\t\t\tif ( child.type === SelectOptionGroup ) {\n\t\t\t\tlet groupLabelMatches = false;\n\n\t\t\t\t// Check if group label matches search term\n\t\t\t\tif ( searchKeyword && ! searchFn ) {\n\t\t\t\t\tconst searchTerm = searchKeyword.toLowerCase();\n\t\t\t\t\tconst groupLabel = child.props.label?.toLowerCase() || '';\n\t\t\t\t\tgroupLabelMatches = groupLabel.includes( searchTerm );\n\t\t\t\t}\n\n\t\t\t\t// Recursively process children of the option group\n\t\t\t\tconst groupChildren = Children.map(\n\t\t\t\t\tchild.props.children,\n\t\t\t\t\t( groupChild ) => {\n\t\t\t\t\t\tif ( ! isValidElement( groupChild ) ) {\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// If group label matches, show all children regardless of their content\n\t\t\t\t\t\tif ( groupLabelMatches ) {\n\t\t\t\t\t\t\tconst childProps = {\n\t\t\t\t\t\t\t\t...( groupChild.props as SelectOptionProps ),\n\t\t\t\t\t\t\t\tindex: childIndex++,\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\treturn cloneElement( groupChild, childProps );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Otherwise, apply normal filtering to individual options\n\t\t\t\t\t\tif ( searchKeyword && ! searchFn ) {\n\t\t\t\t\t\t\tconst textContent = getTextContent(\n\t\t\t\t\t\t\t\t( groupChild.props as { children?: React.ReactNode } ).children\n\t\t\t\t\t\t\t)?.toLowerCase();\n\t\t\t\t\t\t\tconst searchTerm = searchKeyword.toLowerCase();\n\n\t\t\t\t\t\t\tconst textMatch = textContent?.includes( searchTerm );\n\n\t\t\t\t\t\t\tif ( ! textMatch ) {\n\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst childProps = {\n\t\t\t\t\t\t\t...( groupChild.props as SelectOptionProps ),\n\t\t\t\t\t\t\tindex: childIndex++,\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\treturn cloneElement( groupChild, childProps );\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\t// Only render group if it has visible children\n\t\t\t\tconst hasChildren = groupChildren?.some( ( c: React.ReactNode ) => c !== null );\n\n\t\t\t\tif ( ! hasChildren ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst groupProps = {\n\t\t\t\t\t...child.props,\n\t\t\t\t\tchildren: groupChildren,\n\t\t\t\t\tindex: groupIndex,\n\t\t\t\t\ttotalGroups,\n\t\t\t\t};\n\n\t\t\t\tgroupIndex++;\n\t\t\t\treturn cloneElement( child, groupProps );\n\t\t\t}\n\n\t\t\t// Handle regular options when searchFn is not provided\n\t\t\tif ( searchKeyword && ! searchFn ) {\n\t\t\t\tconst textContent = getTextContent(\n\t\t\t\t\tchild.props?.children\n\t\t\t\t)?.toLowerCase();\n\t\t\t\tconst searchTerm = searchKeyword.toLowerCase();\n\n\t\t\t\tconst textMatch = textContent?.includes( searchTerm );\n\n\t\t\t\tif ( ! textMatch ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn cloneElement( child, {\n\t\t\t\t...child.props,\n\t\t\t\tindex: childIndex++,\n\t\t\t} );\n\t\t};\n\n\t\treturn Children.map( children, processChild );\n\t}, [ searchKeyword, value, selected, children, searchFn ] );\n\tconst childrenCount = Children.count( renderChildren );\n\n\t// Update the content list reference.\n\tuseEffect( () => {\n\t\tlistContentRef.current = [];\n\t\t// Get all children as an array.\n\t\tlet allChildren = Children.toArray( children );\n\t\t// If it's an option group and has children.\n\t\tif (\n\t\t\tallChildren &&\n\t\t\tisValidElement( allChildren[ 0 ] ) &&\n\t\t\tallChildren[ 0 ].type === SelectOptionGroup\n\t\t) {\n\t\t\tallChildren = Children.toArray( allChildren )\n\t\t\t\t.map( ( child ) =>\n\t\t\t\t\tisValidElement( child ) ? child.props.children : null\n\t\t\t\t)\n\t\t\t\t.filter( Boolean );\n\t\t}\n\t\t// Update the list content reference.\n\t\tChildren.forEach( allChildren, ( child ) => {\n\t\t\tif ( ! isValidElement( child ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst textContent = getTextContent(\n\t\t\t\tchild.props?.children\n\t\t\t)?.toLowerCase();\n\t\t\t// Handle regular options when searchFn is not provided\n\t\t\tif ( searchKeyword && ! searchFn ) {\n\t\t\t\tconst searchTerm = searchKeyword.toLowerCase();\n\t\t\t\tconst textMatch = textContent?.includes( searchTerm );\n\n\t\t\t\tif ( ! textMatch ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlistContentRef.current.push( textContent );\n\t\t} );\n\t}, [ searchKeyword, searchFn ] );\n\n\tconst [ searching, setSearching ] = useState( false );\n\n\t// Create a function to handle the search function.\n\tconst handleSearchFn = useCallback( async () => {\n\t\tif ( ! searchFn || typeof searchFn !== 'function' || searching ) {\n\t\t\treturn;\n\t\t}\n\n\t\tsetSearching( true );\n\t\ttry {\n\t\t\tawait searchFn( searchKeyword );\n\t\t} catch ( error ) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.error( error );\n\t\t} finally {\n\t\t\tsetSearching( false );\n\t\t}\n\t}, [ searchKeyword ] );\n\n\t// Debounce the search function.\n\tconst initiateSearch = useDebouncedCallback( handleSearchFn, debounceDelay! );\n\n\t// Initiate search when searchFn is a function.\n\tuseEffect( () => {\n\t\tif ( typeof searchFn !== 'function' ) {\n\t\t\treturn;\n\t\t}\n\t\tinitiateSearch();\n\t}, [ initiateSearch ] );\n\n\treturn (\n\t\t<>\n\t\t\t{ /* Dropdown */ }\n\t\t\t{ isOpen && (\n\t\t\t\t<>\n\t\t\t\t\t<FloatingFocusManager\n\t\t\t\t\t\tcontext={ context }\n\t\t\t\t\t\tmodal={ false }\n\t\t\t\t\t\tvisuallyHiddenDismiss\n\t\t\t\t\t>\n\t\t\t\t\t\t{ /* Dropdown Wrapper */ }\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tref={ refs.setFloating }\n\t\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t\t'box-border [&_*]:box-border w-full bg-white outline-none shadow-lg outline outline-1 outline-border-subtle',\n\t\t\t\t\t\t\t\tcombobox &&\n\t\t\t\t\t\t\t\t\t'grid grid-cols-1 grid-rows-[auto_1fr] divide-y divide-x-0 divide-solid divide-border-subtle',\n\t\t\t\t\t\t\t\tsizeClassNames[ sizeValue as SelectSizes ]\n\t\t\t\t\t\t\t\t\t.dropdown,\n\t\t\t\t\t\t\t\t! combobox && 'h-auto',\n\t\t\t\t\t\t\t\t! combobox\n\t\t\t\t\t\t\t\t\t? 'overflow-y-auto overflow-x-hidden'\n\t\t\t\t\t\t\t\t\t: 'overflow-hidden',\n\t\t\t\t\t\t\t\tclassName\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\tstyle={ {\n\t\t\t\t\t\t\t\t...floatingStyles,\n\t\t\t\t\t\t\t\tzIndex: 1,\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t{ ...getFloatingProps() }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ /* Searchbox */ }\n\t\t\t\t\t\t\t{ combobox && (\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t\t\t\tsizeClassNames[ sizeValue as SelectSizes ]\n\t\t\t\t\t\t\t\t\t\t\t.searchbarWrapper\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{ searching ? (\n\t\t\t\t\t\t\t\t\t\t<Loader\n\t\t\t\t\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t\t\t\t\tsizeClassNames[\n\t\t\t\t\t\t\t\t\t\t\t\t\tsizeValue as SelectSizes\n\t\t\t\t\t\t\t\t\t\t\t\t].searchbarIcon\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t<Search\n\t\t\t\t\t\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t\t\t\t\t\t'text-icon-secondary shrink-0',\n\t\t\t\t\t\t\t\t\t\t\t\tsizeClassNames[\n\t\t\t\t\t\t\t\t\t\t\t\t\tsizeValue as SelectSizes\n\t\t\t\t\t\t\t\t\t\t\t\t].searchbarIcon\n\t\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t\t\t\t\t'px-1 w-full placeholder:text-field-placeholder border-0 focus:outline-none focus:shadow-none',\n\t\t\t\t\t\t\t\t\t\t\tsizeClassNames[\n\t\t\t\t\t\t\t\t\t\t\t\tsizeValue as SelectSizes\n\t\t\t\t\t\t\t\t\t\t\t].searchbar\n\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t\ttype=\"search\"\n\t\t\t\t\t\t\t\t\t\tname=\"keyword\"\n\t\t\t\t\t\t\t\t\t\tplaceholder={ searchPlaceholder }\n\t\t\t\t\t\t\t\t\t\tonChange={ ( event ) =>\n\t\t\t\t\t\t\t\t\t\t\tsetSearchKeyword( event.target.value )\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tvalue={ searchKeyword }\n\t\t\t\t\t\t\t\t\t\tautoComplete=\"off\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t{ /* Dropdown Items Wrapper */ }\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t\t\t'overflow-y-auto overflow-x-hidden',\n\t\t\t\t\t\t\t\t\t! combobox && 'w-full h-full',\n\t\t\t\t\t\t\t\t\tsizeClassNames[ sizeValue as SelectSizes ]\n\t\t\t\t\t\t\t\t\t\t.dropdownItemsWrapper\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ /* Dropdown Items */ }\n\t\t\t\t\t\t\t\t{ !! childrenCount && renderChildren }\n\n\t\t\t\t\t\t\t\t{ /* No items found */ }\n\t\t\t\t\t\t\t\t{ ! childrenCount && (\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t\t\t\t\t'p-2 text-center font-medium text-field-placeholder',\n\t\t\t\t\t\t\t\t\t\t\tselectItemClassNames[\n\t\t\t\t\t\t\t\t\t\t\t\tsizeValue as SelectSizes\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\tNo items found\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</FloatingFocusManager>\n\t\t\t\t</>\n\t\t\t) }\n\t\t</>\n\t);\n}\n\nexport function SelectPortal( { children, root, id }: SelectPortalProps ) {\n\treturn (\n\t\t<FloatingPortal id={ id } root={ root }>\n\t\t\t{ children }\n\t\t</FloatingPortal>\n\t);\n}\n\nexport function SelectItem( {\n\tvalue,\n\tselected,\n\tchildren,\n\tclassName,\n\t...props\n}: SelectOptionProps ) {\n\tconst {\n\t\tsizeValue,\n\t\tgetItemProps,\n\t\tonKeyDownItem,\n\t\tonClickItem,\n\t\tactiveIndex,\n\t\tselectedIndex,\n\t\tupdateListRef,\n\t\tgetValues,\n\t\tby,\n\t\tmultiple,\n\t} = useSelectContext();\n\tconst { index: indx } = props;\n\tconst initialIndxRef = useRef( indx );\n\n\tconst selectedIconClassName = {\n\t\tsm: 'size-4',\n\t\tmd: 'size-4',\n\t\tlg: 'size-5',\n\t};\n\n\tconst multipleChecked = useMemo( () => {\n\t\tif ( ! multiple ) {\n\t\t\treturn false;\n\t\t}\n\t\tconst currentValue = getValues();\n\t\tif ( ! currentValue ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn ( currentValue as SelectOptionValue[] ).some( ( val ) => {\n\t\t\tif ( val !== null && value !== null && typeof val === 'object' ) {\n\t\t\t\treturn (\n\t\t\t\t\t( val as Record<string, unknown> )[ by ] ===\n\t\t\t\t\t( value as Record<string, unknown> )[ by ]\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn val === value;\n\t\t} );\n\t}, [ value, getValues ] );\n\n\tconst isChecked = useMemo( () => {\n\t\tif ( typeof selected === 'boolean' ) {\n\t\t\treturn selected;\n\t\t}\n\n\t\tif ( multiple ) {\n\t\t\treturn multipleChecked;\n\t\t}\n\n\t\treturn indx === selectedIndex;\n\t}, [ multipleChecked, selectedIndex, selected ] );\n\n\treturn (\n\t\t<div\n\t\t\tclassName={ cn(\n\t\t\t\t'w-full flex items-center justify-between text-text-primary hover:bg-button-tertiary-hover rounded-md transition-all duration-150 cursor-pointer focus:outline-none focus-within:outline-none outline-none',\n\t\t\t\tselectItemClassNames[ sizeValue as SelectSizes ],\n\t\t\t\tindx === activeIndex && 'bg-button-tertiary-hover',\n\t\t\t\tclassName\n\t\t\t) }\n\t\t\tref={ ( node ) => {\n\t\t\t\tupdateListRef( indx as number, node as HTMLElement );\n\t\t\t} }\n\t\t\trole=\"option\"\n\t\t\ttabIndex={ indx === activeIndex ? 0 : -1 }\n\t\t\taria-selected={ isChecked && indx === activeIndex }\n\t\t\t{ ...getItemProps( {\n\t\t\t\t// Handle pointer select.\n\t\t\t\tonClick() {\n\t\t\t\t\tonClickItem( initialIndxRef.current as number, value );\n\t\t\t\t},\n\t\t\t\t// Handle keyboard select.\n\t\t\t\tonKeyDown( event: React.KeyboardEvent ) {\n\t\t\t\t\tonKeyDownItem(\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\tinitialIndxRef.current as number,\n\t\t\t\t\t\tvalue\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t} ) }\n\t\t>\n\t\t\t<span className=\"w-full truncate\">{ children }</span>\n\t\t\t{ isChecked && (\n\t\t\t\t<CheckIcon\n\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t'text-icon-on-color-disabled',\n\t\t\t\t\t\tselectedIconClassName[ sizeValue as SelectSizes ]\n\t\t\t\t\t) }\n\t\t\t\t/>\n\t\t\t) }\n\t\t</div>\n\t);\n}\n\nconst SelectComponent = ( {\n\tid,\n\tsize: sizeValue = 'md', // sm, md, lg\n\tvalue, // Value of the select (for controlled component).\n\tdefaultValue, // Default value of the select (for uncontrolled component).\n\tonChange, // Callback function to handle the change event.\n\tby = 'id', // Used to identify the select component. Default is 'id'.\n\tchildren,\n\tmultiple = false, // If true, it will allow multiple selection.\n\tcombobox = false, // If true, it will show a search box.\n\tdisabled = false, // If true, it will disable the select component.\n\tsearchPlaceholder = 'Search...', // Placeholder text for search box.\n\tsearchFn, // Function to handle the search.\n\tdebounceDelay = 500, // Debounce delay for the search.\n}: SelectProps ) => {\n\tconst selectId = useMemo( () => id || `select-${ nanoid() }`, [ id ] );\n\tconst isControlled = useMemo( () => typeof value !== 'undefined', [ value ] );\n\tconst [ selected, setSelected ] = useState<\n\t\tSelectOptionValue | SelectOptionValue[]\n\t>( defaultValue! );\n\tconst [ searchKeyword, setSearchKeyword ] = useState( '' );\n\n\tconst getValues = useCallback<SelectGetValues>( () => {\n\t\tif ( isControlled ) {\n\t\t\treturn value as string | number | Record<string, unknown>;\n\t\t}\n\t\treturn selected as string | number | Record<string, unknown>;\n\t}, [ isControlled, value, selected ] );\n\n\t// Dropdown position related code (Start)\n\tconst [ isOpen, setIsOpen ] = useState( false );\n\tconst [ activeIndex, setActiveIndex ] = useState<number | null>( null );\n\tconst [ selectedIndex, setSelectedIndex ] = useState<number | null>( null );\n\n\tconst dropdownMaxHeightBySize = {\n\t\tsm: combobox ? 256 : 172,\n\t\tmd: combobox ? 256 : 216,\n\t\tlg: combobox ? 256 : 216,\n\t};\n\n\tconst { refs, floatingStyles, context } = useFloating( {\n\t\tstrategy: 'fixed',\n\t\tplacement: 'bottom-start',\n\t\topen: isOpen,\n\t\tonOpenChange: setIsOpen,\n\t\twhileElementsMounted: autoUpdate,\n\t\tmiddleware: [\n\t\t\toffset( 5 ),\n\t\t\tflip( { padding: 10 } ),\n\t\t\tsize( {\n\t\t\t\tapply( { rects, elements, availableHeight } ) {\n\t\t\t\t\tObject.assign( elements.floating.style, {\n\t\t\t\t\t\tmaxHeight: `min(${ availableHeight }px, ${ dropdownMaxHeightBySize[ sizeValue as SelectSizes ] }px)`,\n\t\t\t\t\t\tmaxWidth: `${ rects.reference.width }px`,\n\t\t\t\t\t} );\n\t\t\t\t},\n\t\t\t\tpadding: 10,\n\t\t\t} ),\n\t\t],\n\t} );\n\n\tconst listRef = useRef<Array<HTMLElement | null>>( [] );\n\tconst listContentRef = useRef( [] );\n\tconst isTypingRef = useRef( false );\n\n\tconst click = useClick( context, { event: 'mousedown' } );\n\tconst dismiss = useDismiss( context );\n\tconst role = useRole( context, { role: 'listbox' } );\n\tconst listNav = useListNavigation( context, {\n\t\tlistRef,\n\t\tactiveIndex,\n\t\tselectedIndex,\n\t\tonNavigate: setActiveIndex,\n\t\t// This is a large list, allow looping.\n\t\tloop: true,\n\t} );\n\tconst typeahead = useTypeahead( context, {\n\t\tlistRef: listContentRef,\n\t\tactiveIndex,\n\t\tselectedIndex,\n\t\tonMatch: isOpen ? setActiveIndex : setSelectedIndex,\n\t\tonTypingChange( isTyping ) {\n\t\t\tisTypingRef.current = isTyping;\n\t\t},\n\t} );\n\n\tconst { getReferenceProps, getFloatingProps, getItemProps } =\n\t\tuseInteractions( [\n\t\t\tdismiss,\n\t\t\trole,\n\t\t\tlistNav,\n\t\t\tclick,\n\t\t\t...( ! combobox ? [ typeahead ] : [] ),\n\t\t] );\n\n\tconst handleMultiSelect: OnClick = ( index, newValue ) => {\n\t\tconst selectedValues = [\n\t\t\t...( ( getValues() as SelectOptionValue[] ) ?? [] ),\n\t\t];\n\t\tconst valueIndex = selectedValues.findIndex( ( selectedValue ) => {\n\t\t\tif (\n\t\t\t\tselectedValue !== null &&\n\t\t\t\tnewValue !== null &&\n\t\t\t\ttypeof selectedValue === 'object'\n\t\t\t) {\n\t\t\t\treturn (\n\t\t\t\t\t( selectedValue as Record<string, unknown> )[ by ] ===\n\t\t\t\t\t( newValue as Record<string, unknown> )[ by ]\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn selectedValue === newValue;\n\t\t} );\n\n\t\tif ( valueIndex !== -1 ) {\n\t\t\treturn;\n\t\t}\n\t\tselectedValues.push( newValue );\n\n\t\tif ( ! isControlled ) {\n\t\t\tsetSelected( selectedValues );\n\t\t}\n\t\tsetSelectedIndex( index );\n\t\t( refs.reference.current as HTMLElement ).focus();\n\t\tsetIsOpen( false );\n\t\tsetSearchKeyword( '' );\n\t\tif ( typeof onChange === 'function' ) {\n\t\t\tonChange( selectedValues );\n\t\t}\n\t};\n\n\tconst handleSelect: OnClick = ( index, newValue ) => {\n\t\tif ( multiple ) {\n\t\t\treturn handleMultiSelect( index, newValue );\n\t\t}\n\t\tsetSelectedIndex( index );\n\t\tif ( ! isControlled ) {\n\t\t\tsetSelected( newValue );\n\t\t}\n\t\t( refs.reference.current as HTMLElement ).focus();\n\t\tsetIsOpen( false );\n\t\tsetSearchKeyword( '' );\n\t\tif ( typeof onChange === 'function' ) {\n\t\t\tonChange( newValue );\n\t\t}\n\t};\n\t// Dropdown position related code (End)\n\n\tconst updateListRef = useCallback( ( index: number, node: HTMLElement ) => {\n\t\tlistRef.current[ index ] = node;\n\t}, [] );\n\n\tconst onClickItem: OnClick = ( index, newValue ) => {\n\t\thandleSelect( index, newValue );\n\t};\n\n\tconst onKeyDownItem: OnKeyDown = ( event, index, newValue ) => {\n\t\tif ( event.key === 'Enter' ) {\n\t\t\tevent.preventDefault();\n\t\t\thandleSelect( index, newValue );\n\t\t}\n\n\t\tif ( event.key === ' ' && ! isTypingRef.current ) {\n\t\t\tevent.preventDefault();\n\t\t\thandleSelect( index, newValue );\n\t\t}\n\t};\n\n\treturn (\n\t\t<SelectContext.Provider\n\t\t\tvalue={ {\n\t\t\t\tselectedIndex,\n\t\t\t\tsetSelectedIndex,\n\t\t\t\tactiveIndex,\n\t\t\t\tsetActiveIndex,\n\t\t\t\tselected,\n\t\t\t\tsetSelected,\n\t\t\t\thandleSelect,\n\t\t\t\tcombobox,\n\t\t\t\tsizeValue,\n\t\t\t\tmultiple,\n\t\t\t\tonChange,\n\t\t\t\tisTypingRef,\n\t\t\t\tgetItemProps,\n\t\t\t\tonClickItem,\n\t\t\t\tonKeyDownItem,\n\t\t\t\tgetValues,\n\t\t\t\tselectId,\n\t\t\t\tgetReferenceProps,\n\t\t\t\tisOpen,\n\t\t\t\tvalue,\n\t\t\t\tupdateListRef,\n\t\t\t\trefs,\n\t\t\t\tlistContentRef,\n\t\t\t\tby,\n\t\t\t\tgetFloatingProps,\n\t\t\t\tfloatingStyles,\n\t\t\t\tcontext,\n\t\t\t\tsearchKeyword,\n\t\t\t\tsetSearchKeyword,\n\t\t\t\tdisabled,\n\t\t\t\tisControlled,\n\t\t\t\tsearchPlaceholder,\n\t\t\t\tsearchFn,\n\t\t\t\tdebounceDelay,\n\t\t\t} }\n\t\t>\n\t\t\t{ children }\n\t\t</SelectContext.Provider>\n\t);\n};\n\nSelectComponent.displayName = 'Select';\n\nconst Select = Object.assign( SelectComponent, {\n\tPortal: SelectPortal,\n\tButton: SelectButton,\n\tOptions: SelectOptions,\n\tOption: SelectItem,\n\tOptionGroup: SelectOptionGroup,\n} );\n\nSelectPortal.displayName = 'Select.Portal';\nSelectButton.displayName = 'Select.Button';\nSelectOptions.displayName = 'Select.Options';\nSelectItem.displayName = 'Select.Option';\nSelectOptionGroup.displayName = 'Select.OptionGroup';\n\nexport default Select;\n"],"names":["SelectContext","createContext","useSelectContext","useContext","SelectButton","forwardRef","children","icon","placeholder","optionIcon","render","label","className","props","ref","sizeValue","getReferenceProps","getValues","selectId","refs","isOpen","multiple","combobox","setSelected","onChange","isControlled","disabled","by","badgeSize","getIcon","useCallback","iconClassNames","disabledClassNames","ChevronsUpDown","jsx","ChevronDown","renderSelected","selectedValue","valueItem","index","Badge","handleOnCloseItem","renderValue","childProps","isValidElement","cn","sizeClassNames","value","event","selectedValues","selectedIndex","val","jsxs","mergeRefs","SelectOptionGroup","totalGroups","Fragment","Children","optionGroupDividerClassNames","optionGroupDividerSizeClassNames","SelectOptions","context","floatingStyles","getFloatingProps","setSearchKeyword","setActiveIndex","setSelectedIndex","selected","searchKeyword","listContentRef","searchPlaceholder","activeIndex","searchFn","debounceDelay","initialSelectedValueIndex","useMemo","currentValue","indexValue","allChildren","group","child","childValue","useLayoutEffect","renderChildren","visibleGroups","hasVisibleChildren","searchTerm","groupLabelMatches","hasMatchingChildren","groupChild","getTextContent","childIndex","groupIndex","processChild","groupChildren","cloneElement","textContent","c","groupProps","childrenCount","useEffect","searching","setSearching","useState","handleSearchFn","error","initiateSearch","useDebouncedCallback","FloatingFocusManager","Loader","Search","selectItemClassNames","SelectPortal","root","id","FloatingPortal","SelectItem","getItemProps","onKeyDownItem","onClickItem","updateListRef","indx","initialIndxRef","useRef","selectedIconClassName","multipleChecked","isChecked","node","CheckIcon","SelectComponent","defaultValue","nanoid","setIsOpen","dropdownMaxHeightBySize","useFloating","autoUpdate","offset","flip","size","rects","elements","availableHeight","listRef","isTypingRef","click","useClick","dismiss","useDismiss","role","useRole","listNav","useListNavigation","typeahead","useTypeahead","isTyping","useInteractions","handleMultiSelect","newValue","handleSelect","Select"],"mappings":"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"}