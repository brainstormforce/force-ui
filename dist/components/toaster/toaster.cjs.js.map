{"version":3,"file":"toaster.cjs.js","sources":["../../../src/components/toaster/toaster.tsx"],"sourcesContent":["import { useEffect, useRef, useState } from 'react';\nimport { X } from 'lucide-react';\nimport { ToastState } from './controller';\nimport { withSingleton } from '@/hoc';\nimport { cn } from '@/utilities/functions';\nimport { getIcon, getAction, getContent, getTitle } from './utils';\nimport {\n\tcloseIconClassNames,\n\tcontainerVariantClassNames,\n\tpositionClassNames,\n\tvariantClassNames,\n} from './component-style';\nimport { flushSync } from 'react-dom';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport type { ToasterProps, ToastProps, ToastType } from './toaster-types';\n\nexport const Toaster = ( {\n\tposition = 'top-right', // top-right/top-left/bottom-right/bottom-left\n\tdesign = 'stack', // stack/inline\n\ttheme = 'light', // light/dark\n\tclassName = '',\n\tautoDismiss = true, // Auto dismiss the toast after a certain time.\n\tdismissAfter = 5000, // Time in milliseconds after which the toast will be dismissed.\n}: ToasterProps ) => {\n\tconst [ toasts, setToasts ] = useState<ToastType[] | []>( [] );\n\n\tuseEffect( () => {\n\t\tToastState.subscribe( ( toastItem ) => {\n\t\t\tif ( toastItem?.dismiss ) {\n\t\t\t\tsetToasts( ( prevToasts ) =>\n\t\t\t\t\tprevToasts.map( ( tItem ) =>\n\t\t\t\t\t\ttItem.id === toastItem.id\n\t\t\t\t\t\t\t? { ...tItem, dismiss: true }\n\t\t\t\t\t\t\t: tItem\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsetTimeout( () => {\n\t\t\t\tflushSync( () =>\n\t\t\t\t\tsetToasts( ( prevToasts ) => {\n\t\t\t\t\t\tconst itemExists = prevToasts.findIndex(\n\t\t\t\t\t\t\t( tItem ) => tItem.id === toastItem.id\n\t\t\t\t\t\t);\n\t\t\t\t\t\t// Update the existing toast.\n\t\t\t\t\t\tif ( itemExists !== -1 ) {\n\t\t\t\t\t\t\treturn prevToasts.map( ( tItem ) => {\n\t\t\t\t\t\t\t\tif ( tItem.id === toastItem.id ) {\n\t\t\t\t\t\t\t\t\treturn { ...tItem, ...toastItem };\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn tItem;\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn [ ...prevToasts, toastItem ];\n\t\t\t\t\t} )\n\t\t\t\t);\n\t\t\t} );\n\t\t} );\n\t}, [] );\n\n\tconst removeToast = ( id: number ) => {\n\t\tsetToasts( ( prevToasts ) => prevToasts.filter( ( t ) => t.id !== id ) );\n\t};\n\n\treturn (\n\t\t<ul\n\t\t\tclassName={ cn(\n\t\t\t\t'fixed flex flex-col list-none z-20 p-10 pointer-events-none [&>li]:pointer-events-auto gap-3',\n\t\t\t\tpositionClassNames[ position ] ?? positionClassNames[ 'top-right' ],\n\t\t\t\tclassName\n\t\t\t) }\n\t\t>\n\t\t\t{ /* Main container */ }\n\t\t\t<AnimatePresence initial={ false }>\n\t\t\t\t{ toasts.map( ( toastItem ) => (\n\t\t\t\t\t<motion.li\n\t\t\t\t\t\tkey={ toastItem.id }\n\t\t\t\t\t\t// positionTransition\n\t\t\t\t\t\tinitial={ { opacity: 0, y: 50, scale: 0.7 } }\n\t\t\t\t\t\tanimate={ { opacity: 1, y: 0, scale: 1 } }\n\t\t\t\t\t\texit={ {\n\t\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\t\tscale: 0.6,\n\t\t\t\t\t\t\ttransition: { duration: 0.15 },\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tlayoutId={ `toast-${ toastItem.id }` }\n\t\t\t\t\t>\n\t\t\t\t\t\t<Toast\n\t\t\t\t\t\t\ttoastItem={ toastItem }\n\t\t\t\t\t\t\ttitle={ toastItem.title }\n\t\t\t\t\t\t\tcontent={ toastItem?.description }\n\t\t\t\t\t\t\ticon={ toastItem?.icon ?? undefined }\n\t\t\t\t\t\t\tdesign={ toastItem?.design ?? design }\n\t\t\t\t\t\t\tautoDismiss={ toastItem?.autoDismiss ?? autoDismiss }\n\t\t\t\t\t\t\tdismissAfter={\n\t\t\t\t\t\t\t\ttoastItem?.dismissAfter ?? dismissAfter\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tremoveToast={ removeToast }\n\t\t\t\t\t\t\tvariant={ toastItem.type }\n\t\t\t\t\t\t\ttheme={ toastItem?.theme ?? theme }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</motion.li>\n\t\t\t\t) ) }\n\t\t\t</AnimatePresence>\n\t\t</ul>\n\t);\n};\n\nexport const Toast = ( {\n\ttoastItem,\n\ttitle = '',\n\tcontent = '',\n\tautoDismiss = true,\n\tdismissAfter = 5000,\n\ttheme = 'light', // light/dark\n\tdesign = 'stack', // inline/stack\n\ticon,\n\tvariant = 'neutral', // neutral/info/success/warning/danger\n\tremoveToast, // Function to remove the toast.\n}: ToastProps ) => {\n\tconst closeTimerStart = useRef( 0 );\n\tconst lastCloseTimerStart = useRef( 0 );\n\tconst timeoutId = useRef<NodeJS.Timeout | undefined>();\n\n\tconst startTimer = (\n\t\ttItem: Partial<ToastType>,\n\t\tremainingTime = dismissAfter\n\t) => {\n\t\t// If auto dismiss is disabled, or the dismissAfter is less than 0, return.\n\t\tif ( ! autoDismiss || dismissAfter < 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tcloseTimerStart.current = new Date().getTime();\n\t\treturn setTimeout( () => {\n\t\t\tif ( typeof removeToast !== 'function' ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tremoveToast( tItem.id! );\n\t\t}, remainingTime );\n\t};\n\n\tconst pauseTimer = () => {\n\t\tclearTimeout( timeoutId.current );\n\t\tlastCloseTimerStart.current = new Date().getTime();\n\t};\n\n\tconst continueTimer = () => {\n\t\ttimeoutId.current = startTimer(\n\t\t\ttoastItem,\n\t\t\tdismissAfter -\n\t\t\t\t( lastCloseTimerStart.current - closeTimerStart.current )\n\t\t);\n\t};\n\n\t// Start the timer when the component mounts.\n\tuseEffect( () => {\n\t\tconst remainingTime = dismissAfter;\n\n\t\ttimeoutId.current = startTimer( toastItem, remainingTime );\n\t\treturn () => {\n\t\t\tclearTimeout( timeoutId.current );\n\t\t};\n\t}, [] );\n\n\tuseEffect( () => {\n\t\tif ( ! toastItem?.dismiss || typeof removeToast !== 'function' ) {\n\t\t\treturn;\n\t\t}\n\t\tremoveToast( toastItem.id! );\n\t}, [ toastItem ] );\n\n\tconst handleAction = () => {\n\t\tif ( typeof removeToast !== 'function' ) {\n\t\t\treturn;\n\t\t}\n\t\ttoastItem?.action?.onClick?.( () => removeToast( toastItem.id! ) );\n\t};\n\n\tlet render = null;\n\tif ( design === 'stack' ) {\n\t\trender = (\n\t\t\t<div\n\t\t\t\tclassName={ cn(\n\t\t\t\t\t'flex items-center justify-start p-4 gap-2 relative border border-solid rounded-md shadow-lg',\n\t\t\t\t\ttheme === 'dark'\n\t\t\t\t\t\t? variantClassNames.dark\n\t\t\t\t\t\t: variantClassNames.light?.[ variant ],\n\t\t\t\t\tcontainerVariantClassNames.stack\n\t\t\t\t) }\n\t\t\t\tonMouseEnter={ pauseTimer }\n\t\t\t\tonMouseLeave={ continueTimer }\n\t\t\t>\n\t\t\t\t{ toastItem.type !== 'custom' ? (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<div className=\"self-start flex items-center justify-center [&_svg]:size-5 shrink-0\">\n\t\t\t\t\t\t\t{ getIcon( { variant, icon, theme } ) }\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"flex flex-col items-start justify-start gap-0.5 mr-6\">\n\t\t\t\t\t\t\t{ getTitle( { title, theme } ) }\n\t\t\t\t\t\t\t{ getContent( { content, theme } ) }\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttoastItem?.action?.label &&\n\t\t\t\t\t\t\t\t\ttypeof toastItem?.action?.onClick ===\n\t\t\t\t\t\t\t\t\t\t'function' && (\n\t\t\t\t\t\t\t\t/* eslint-disable */\n\t\t\t\t\t\t\t\t\t\t<div className=\"mt-2.5\">\n\t\t\t\t\t\t\t\t\t\t\t{getAction({\n\t\t\t\t\t\t\t\t\t\t\t\tactionLabel:\n\t\t\t\t\t\t\t\t\t\t\t\t\ttoastItem?.action?.label,\n\t\t\t\t\t\t\t\t\t\t\t\tactionType:\n\t\t\t\t\t\t\t\t\t\t\t\t\ttoastItem?.action?.type ??\n\t\t\t\t\t\t\t\t\t\t\t\t\t'button',\n\t\t\t\t\t\t\t\t\t\t\t\tonAction: handleAction,\n\t\t\t\t\t\t\t\t\t\t\t\ttheme,\n\t\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t/* eslint-enable */\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"absolute right-4 top-4 [&_svg]:size-5\">\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t\t\t'bg-transparent m-0 p-0 border-none focus:outline-none active:outline-none cursor-pointer',\n\t\t\t\t\t\t\t\t\tcloseIconClassNames[ theme ] ??\n\t\t\t\t\t\t\t\t\t\tcloseIconClassNames.light\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\t\tif ( typeof removeToast !== 'function' ) {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tremoveToast( toastItem.id! );\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<X />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</>\n\t\t\t\t) : (\n\t\t\t\t\ttoastItem?.jsx?.( {\n\t\t\t\t\t\tclose: () => removeToast!( toastItem.id! ),\n\t\t\t\t\t\taction: toastItem?.action\n\t\t\t\t\t\t\t? { ...toastItem?.action, onClick: handleAction }\n\t\t\t\t\t\t\t: null,\n\t\t\t\t\t} )\n\t\t\t\t) }\n\t\t\t</div>\n\t\t);\n\t}\n\n\tif ( design === 'inline' ) {\n\t\trender = (\n\t\t\t<div\n\t\t\t\tclassName={ cn(\n\t\t\t\t\t'flex items-center justify-start p-3 gap-2 relative border border-solid rounded-md shadow-lg',\n\t\t\t\t\ttheme === 'dark'\n\t\t\t\t\t\t? variantClassNames.dark\n\t\t\t\t\t\t: variantClassNames.light?.[ variant ],\n\t\t\t\t\tcontainerVariantClassNames.inline\n\t\t\t\t) }\n\t\t\t>\n\t\t\t\t<div className=\"self-start flex items-center justify-center [&_svg]:size-5 shrink-0\">\n\t\t\t\t\t{ getIcon( { variant, icon, theme } ) }\n\t\t\t\t</div>\n\t\t\t\t<div className=\"flex items-start justify-start gap-1 mr-10 [&>span:first-child]:shrink-0\">\n\t\t\t\t\t{ getTitle( { title, theme } ) }\n\t\t\t\t\t{ getContent( { content, theme } ) }\n\t\t\t\t</div>\n\t\t\t\t<div className=\"absolute right-3 top-3 [&_svg]:size-5\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t'bg-transparent m-0 p-0 border-none focus:outline-none active:outline-none cursor-pointer',\n\t\t\t\t\t\t\tcloseIconClassNames[ theme ] ??\n\t\t\t\t\t\t\t\tcloseIconClassNames.light\n\t\t\t\t\t\t) }\n\t\t\t\t\t\tonClick={ () => removeToast!( toastItem.id! ) }\n\t\t\t\t\t>\n\t\t\t\t\t\t<X />\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn render;\n};\n\nexport default withSingleton( Toaster );\n"],"names":["Toaster","position","design","theme","className","autoDismiss","dismissAfter","toasts","setToasts","useState","useEffect","ToastState","toastItem","prevToasts","tItem","flushSync","removeToast","id","t","jsx","cn","positionClassNames","AnimatePresence","motion","Toast","title","content","icon","variant","closeTimerStart","useRef","lastCloseTimerStart","timeoutId","startTimer","remainingTime","pauseTimer","continueTimer","handleAction","render","variantClassNames","containerVariantClassNames","jsxs","Fragment","getIcon","getTitle","getContent","getAction","closeIconClassNames","X","withSingleton"],"mappings":"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"}