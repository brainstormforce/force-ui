{"version":3,"file":"controller.es.js","sources":["../../../src/components/toaster/controller.ts"],"sourcesContent":["import React from 'react';\nimport type { ToastType, Subscriber } from './toaster-types';\n\nlet toastCounter = 1;\n\nclass ToastController {\n\t#toasts: ToastType[];\n\t#subscribers: Subscriber[];\n\n\tconstructor() {\n\t\tthis.#toasts = [];\n\t\tthis.#subscribers = [];\n\t}\n\n\t// Subscriber pattern.\n\tsubscribe( callback: Subscriber ) {\n\t\tthis.#subscribers.push( callback );\n\n\t\t// Return a callback for unsubscribe.\n\t\treturn () => {\n\t\t\tthis.#subscribers = this.#subscribers.filter(\n\t\t\t\t( subscriber ) => subscriber !== callback\n\t\t\t);\n\t\t};\n\t}\n\n\t// Publish a new toast.\n\tpublish( toast: ToastType ) {\n\t\tthis.#subscribers.forEach( ( subscriber ) => subscriber( toast ) );\n\t}\n\n\t// Add a new toast.\n\tadd( toast: ToastType ) {\n\t\tthis.#toasts.push( toast );\n\n\t\t// Publish the new toast.\n\t\tthis.publish( toast );\n\t}\n\n\t// Remove a toast.\n\tremove( id: number ) {\n\t\tthis.#toasts = this.#toasts.filter( ( toast ) => toast.id !== id );\n\n\t\treturn id;\n\t}\n\n\t// Create a new toast.\n\tcreate(\n\t\tdata: Partial<ToastType & { message: string | React.ReactElement }>\n\t) {\n\t\tconst {\n\t\t\tid = undefined,\n\t\t\tmessage = '',\n\t\t\tjsx = undefined,\n\t\t\t...restData\n\t\t} = data;\n\n\t\tif ( ! message && typeof jsx !== 'function' ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst toastId = typeof id === 'number' ? id : toastCounter++;\n\t\tconst toastExists = this.#toasts.find( ( toast ) => toast.id === toastId );\n\n\t\tif ( toastExists ) {\n\t\t\t// Update the existing toast.\n\t\t\tthis.#toasts = this.#toasts.map( ( toast ) => {\n\t\t\t\tif ( toast.id === toastId ) {\n\t\t\t\t\tthis.publish( {\n\t\t\t\t\t\t...toast,\n\t\t\t\t\t\ttitle: message,\n\t\t\t\t\t\tjsx,\n\t\t\t\t\t\t...restData,\n\t\t\t\t\t} );\n\t\t\t\t\treturn { ...toast, title: message, jsx, ...restData };\n\t\t\t\t}\n\t\t\t\treturn toast;\n\t\t\t} );\n\t\t}\n\n\t\t// Create a new toast.\n\t\tthis.add( { id: toastId, title: message, jsx, ...restData } );\n\n\t\treturn toastId;\n\t}\n\n\t// Update a toast.\n\tupdate( id: number, data: Partial<ToastType> ) {\n\t\tconst { render = undefined } = data;\n\t\tlet updatedData = data;\n\t\tswitch ( typeof render ) {\n\t\t\tcase 'function':\n\t\t\t\tupdatedData = {\n\t\t\t\t\tjsx: render,\n\t\t\t\t\t...data,\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 'string':\n\t\t\t\tupdatedData = {\n\t\t\t\t\ttitle: render,\n\t\t\t\t\t...data,\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.#toasts = this.#toasts.map( ( toast ) => {\n\t\t\tif ( toast.id === id ) {\n\t\t\t\tthis.publish( { ...toast, ...updatedData } );\n\t\t\t\treturn { ...toast, ...updatedData };\n\t\t\t}\n\t\t\treturn toast;\n\t\t} );\n\t}\n\n\t// Dismiss toast.\n\tdismiss( id: number ) {\n\t\tif ( ! id ) {\n\t\t\tthis.#toasts.forEach( ( toast ) =>\n\t\t\t\tthis.#subscribers.forEach( ( subscriber ) =>\n\t\t\t\t\tsubscriber( { id: toast.id, dismiss: true } )\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tthis.#subscribers.forEach( ( subscriber ) =>\n\t\t\tsubscriber( { id, dismiss: true } )\n\t\t);\n\t\treturn id;\n\t}\n\n\t// History of toasts.\n\thistory() {\n\t\treturn this.#toasts;\n\t}\n\n\t// Types of toasts.\n\n\t// Default toast.\n\tdefault(\n\t\tmessage: string | React.ReactElement = '',\n\t\toptions: Partial<ToastType> = {}\n\t) {\n\t\treturn this.create( { message, type: 'neutral', ...options } );\n\t}\n\n\t// Success toast.\n\tsuccess(\n\t\tmessage: string | React.ReactElement = '',\n\t\toptions: Partial<ToastType> = {}\n\t) {\n\t\treturn this.create( { message, type: 'success', ...options } );\n\t}\n\n\t// Error toast.\n\terror(\n\t\tmessage: string | React.ReactElement = '',\n\t\toptions: Partial<ToastType> = {}\n\t) {\n\t\treturn this.create( { message, type: 'error', ...options } );\n\t}\n\n\t// Warning toast.\n\twarning(\n\t\tmessage: string | React.ReactElement = '',\n\t\toptions: Partial<ToastType> = {}\n\t) {\n\t\treturn this.create( { message, type: 'warning', ...options } );\n\t}\n\n\t// Info toast\n\tinfo(\n\t\tmessage: string | React.ReactElement = '',\n\t\toptions: Partial<ToastType> = {}\n\t) {\n\t\treturn this.create( { message, type: 'info', ...options } );\n\t}\n\n\t// Custom toast.\n\tcustom( jsx: ToastType['jsx'], options: Partial<ToastType> = {} ) {\n\t\treturn this.create( {\n\t\t\tjsx,\n\t\t\ttype: 'custom',\n\t\t\t...options,\n\t\t} );\n\t}\n}\n\nexport const ToastState = new ToastController();\n\nconst defaultToast = (\n\tmessage: string | React.ReactElement,\n\toptions: ToastType\n) => ToastState.default( message, options );\n\nexport const toast = Object.seal(\n\tObject.assign(\n\t\tdefaultToast,\n\t\t{\n\t\t\tsuccess: ToastState.success.bind( ToastState ),\n\t\t\terror: ToastState.error.bind( ToastState ),\n\t\t\twarning: ToastState.warning.bind( ToastState ),\n\t\t\tinfo: ToastState.info.bind( ToastState ),\n\t\t\tcustom: ToastState.custom.bind( ToastState ),\n\t\t\tdismiss: ToastState.dismiss.bind( ToastState ),\n\t\t\tupdate: ToastState.update.bind( ToastState ),\n\t\t},\n\t\t{\n\t\t\tgetHistory: ToastState.history.bind( ToastState ),\n\t\t}\n\t)\n);\n"],"names":["toastCounter","ToastController","#toasts","#subscribers","callback","subscriber","toast","id","data","message","jsx","restData","toastId","render","updatedData","options","ToastState","defaultToast"],"mappings":"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"}