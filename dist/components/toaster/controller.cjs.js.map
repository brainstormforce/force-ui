{"version":3,"file":"controller.cjs.js","sources":["../../../src/components/toaster/controller.ts"],"sourcesContent":["import React from 'react';\nimport type { ToastType, Subscriber } from './toaster-types';\n\nlet toastCounter = 1;\n\nclass ToastController {\n\t#toasts: ToastType[];\n\t#subscribers: Subscriber[];\n\n\tconstructor() {\n\t\tthis.#toasts = [];\n\t\tthis.#subscribers = [];\n\t}\n\n\t// Subscriber pattern.\n\tsubscribe( callback: Subscriber ) {\n\t\tthis.#subscribers.push( callback );\n\n\t\t// Return a callback for unsubscribe.\n\t\treturn () => {\n\t\t\tthis.#subscribers = this.#subscribers.filter(\n\t\t\t\t( subscriber ) => subscriber !== callback\n\t\t\t);\n\t\t};\n\t}\n\n\t// Publish a new toast.\n\tpublish( toast: ToastType ) {\n\t\tthis.#subscribers.forEach( ( subscriber ) => subscriber( toast ) );\n\t}\n\n\t// Add a new toast.\n\tadd( toast: ToastType ) {\n\t\tthis.#toasts.push( toast );\n\n\t\t// Publish the new toast.\n\t\tthis.publish( toast );\n\t}\n\n\t// Remove a toast.\n\tremove( id: number ) {\n\t\tthis.#toasts = this.#toasts.filter( ( toast ) => toast.id !== id );\n\n\t\treturn id;\n\t}\n\n\t// Create a new toast.\n\tcreate(\n\t\tdata: Partial<ToastType & { message: string | React.ReactElement }>\n\t) {\n\t\tconst {\n\t\t\tid = undefined,\n\t\t\tmessage = '',\n\t\t\tjsx = undefined,\n\t\t\t...restData\n\t\t} = data;\n\n\t\tif ( ! message && typeof jsx !== 'function' ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst toastId = typeof id === 'number' ? id : toastCounter++;\n\t\tconst toastExists = this.#toasts.find( ( toast ) => toast.id === toastId );\n\n\t\tif ( toastExists ) {\n\t\t\t// Update the existing toast.\n\t\t\tthis.#toasts = this.#toasts.map( ( toast ) => {\n\t\t\t\tif ( toast.id === toastId ) {\n\t\t\t\t\tthis.publish( {\n\t\t\t\t\t\t...toast,\n\t\t\t\t\t\ttitle: message,\n\t\t\t\t\t\tjsx,\n\t\t\t\t\t\t...restData,\n\t\t\t\t\t} );\n\t\t\t\t\treturn { ...toast, title: message, jsx, ...restData };\n\t\t\t\t}\n\t\t\t\treturn toast;\n\t\t\t} );\n\t\t}\n\n\t\t// Create a new toast.\n\t\tthis.add( { id: toastId, title: message, jsx, ...restData } );\n\n\t\treturn toastId;\n\t}\n\n\t// Update a toast.\n\tupdate( id: number, data: Partial<ToastType> ) {\n\t\tconst { render = undefined } = data;\n\t\tlet updatedData = data;\n\t\tswitch ( typeof render ) {\n\t\t\tcase 'function':\n\t\t\t\tupdatedData = {\n\t\t\t\t\tjsx: render,\n\t\t\t\t\t...data,\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 'string':\n\t\t\t\tupdatedData = {\n\t\t\t\t\ttitle: render,\n\t\t\t\t\t...data,\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.#toasts = this.#toasts.map( ( toast ) => {\n\t\t\tif ( toast.id === id ) {\n\t\t\t\tthis.publish( { ...toast, ...updatedData } );\n\t\t\t\treturn { ...toast, ...updatedData };\n\t\t\t}\n\t\t\treturn toast;\n\t\t} );\n\t}\n\n\t// Dismiss toast.\n\tdismiss( id: number ) {\n\t\tif ( ! id ) {\n\t\t\tthis.#toasts.forEach( ( toast ) =>\n\t\t\t\tthis.#subscribers.forEach( ( subscriber ) =>\n\t\t\t\t\tsubscriber( { id: toast.id, dismiss: true } )\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tthis.#subscribers.forEach( ( subscriber ) =>\n\t\t\tsubscriber( { id, dismiss: true } )\n\t\t);\n\t\treturn id;\n\t}\n\n\t// History of toasts.\n\thistory() {\n\t\treturn this.#toasts;\n\t}\n\n\t// Types of toasts.\n\n\t// Default toast.\n\tdefault(\n\t\tmessage: string | React.ReactElement = '',\n\t\toptions: Partial<ToastType> = {}\n\t) {\n\t\treturn this.create( { message, type: 'neutral', ...options } );\n\t}\n\n\t// Success toast.\n\tsuccess(\n\t\tmessage: string | React.ReactElement = '',\n\t\toptions: Partial<ToastType> = {}\n\t) {\n\t\treturn this.create( { message, type: 'success', ...options } );\n\t}\n\n\t// Error toast.\n\terror(\n\t\tmessage: string | React.ReactElement = '',\n\t\toptions: Partial<ToastType> = {}\n\t) {\n\t\treturn this.create( { message, type: 'error', ...options } );\n\t}\n\n\t// Warning toast.\n\twarning(\n\t\tmessage: string | React.ReactElement = '',\n\t\toptions: Partial<ToastType> = {}\n\t) {\n\t\treturn this.create( { message, type: 'warning', ...options } );\n\t}\n\n\t// Info toast\n\tinfo(\n\t\tmessage: string | React.ReactElement = '',\n\t\toptions: Partial<ToastType> = {}\n\t) {\n\t\treturn this.create( { message, type: 'info', ...options } );\n\t}\n\n\t// Custom toast.\n\tcustom( jsx: ToastType['jsx'], options: Partial<ToastType> = {} ) {\n\t\treturn this.create( {\n\t\t\tjsx,\n\t\t\ttype: 'custom',\n\t\t\t...options,\n\t\t} );\n\t}\n}\n\nexport const ToastState = new ToastController();\n\nconst defaultToast = (\n\tmessage: string | React.ReactElement,\n\toptions: ToastType\n) => ToastState.default( message, options );\n\nexport const toast = Object.seal(\n\tObject.assign(\n\t\tdefaultToast,\n\t\t{\n\t\t\tsuccess: ToastState.success.bind( ToastState ),\n\t\t\terror: ToastState.error.bind( ToastState ),\n\t\t\twarning: ToastState.warning.bind( ToastState ),\n\t\t\tinfo: ToastState.info.bind( ToastState ),\n\t\t\tcustom: ToastState.custom.bind( ToastState ),\n\t\t\tdismiss: ToastState.dismiss.bind( ToastState ),\n\t\t\tupdate: ToastState.update.bind( ToastState ),\n\t\t},\n\t\t{\n\t\t\tgetHistory: ToastState.history.bind( ToastState ),\n\t\t}\n\t)\n);\n"],"names":["toastCounter","ToastController","#toasts","#subscribers","callback","subscriber","toast","id","data","message","jsx","restData","toastId","render","updatedData","options","ToastState","defaultToast"],"mappings":"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"}