{"version":3,"file":"dropzone.cjs.js","sources":["../../../src/components/dropzone/dropzone.tsx"],"sourcesContent":["import { useState, createContext, useContext, useRef, useMemo } from 'react';\nimport { CloudUpload, File, ImageOff, Trash } from 'lucide-react';\nimport { cn, formatFileSize } from '@/utilities/functions';\nimport Loader from '@/components/loader';\nimport { nanoid } from 'nanoid';\n\nexport interface DropzoneProps {\n\t/** Callback function when a file is uploaded */\n\tonFileUpload?: ( file: File ) => void;\n\t/** Determines if the icon should be inline */\n\tinlineIcon?: boolean;\n\t/** Label for the dropzone */\n\tlabel?: string;\n\t/** Help text for the dropzone */\n\thelpText?: string;\n\t/** Size variant of the dropzone */\n\tsize?: 'sm' | 'md' | 'lg';\n\t/** Indicates if the component is disabled */\n\tdisabled?: boolean;\n\t/** Indicates if the component is in error state */\n\terror?: boolean;\n\t/** Error text to display */\n\terrorText?: string;\n}\n\n// Context interface for file data sharing\nexport interface FileUploadContextType {\n\tfile: File | null;\n\tremoveFile: () => void;\n\tisLoading: boolean;\n\terror: boolean;\n\terrorText?: string;\n}\n\n// Create a context to share file data between Dropzone and FilePreview\nconst FileUploadContext = createContext<FileUploadContextType | null>( null );\n\nconst useFileUploadContext = () => useContext( FileUploadContext );\n\n// FilePreview\nexport const FilePreview = () => {\n\tconst { file, removeFile, isLoading, error, errorText } =\n\t\tuseFileUploadContext()!;\n\n\tconst renderFileIcon = useMemo( () => {\n\t\treturn (\n\t\t\t<span className=\"inline-flex self-start p-0.5\">\n\t\t\t\t<File className=\"size-5 text-icon-primary\" />\n\t\t\t</span>\n\t\t);\n\t}, [ file ] );\n\n\tif ( ! file ) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<div\n\t\t\tclassName={ cn(\n\t\t\t\t'border border-solid border-transparent flex items-start justify-between rounded mt-2 bg-field-primary-background p-3 gap-3',\n\t\t\t\terror && 'border-alert-border-danger bg-alert-background-danger'\n\t\t\t) }\n\t\t>\n\t\t\t<div className=\"flex items-center gap-3 w-full\">\n\t\t\t\t{ isLoading && renderFileIcon }\n\t\t\t\t{ ! isLoading &&\n\t\t\t\t\t( file.type.startsWith( 'image/' ) ? (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t\t'size-10 rounded-sm flex items-center justify-center shrink-0',\n\t\t\t\t\t\t\t\terror && 'bg-gray-200 '\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ error ? (\n\t\t\t\t\t\t\t\t<ImageOff className=\"size-6 text-field-helper\" />\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\tsrc={ URL.createObjectURL( file ) }\n\t\t\t\t\t\t\t\t\talt=\"Preview\"\n\t\t\t\t\t\t\t\t\tclassName=\"w-full h-10 object-contain\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) : (\n\t\t\t\t\t\trenderFileIcon\n\t\t\t\t\t) ) }\n\n\t\t\t\t<div className=\"text-left flex flex-col gap-1 w-[calc(100%_-_5.5rem)]\">\n\t\t\t\t\t<span className=\"text-sm font-medium text-field-label truncate\">\n\t\t\t\t\t\t{ isLoading ? 'Loading...' : file.name }\n\t\t\t\t\t</span>\n\t\t\t\t\t{ ! isLoading && (\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t\t'text-xs text-field-helper',\n\t\t\t\t\t\t\t\terror && 'text-support-error'\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ error ? errorText : formatFileSize( file.size ) }\n\t\t\t\t\t\t</span>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t\t{ isLoading ? (\n\t\t\t\t\t<span className=\"inline-flex ml-auto p-0.5\">\n\t\t\t\t\t\t<Loader className=\"inline-flex\" />\n\t\t\t\t\t</span>\n\t\t\t\t) : (\n\t\t\t\t\t<button\n\t\t\t\t\t\tonClick={ removeFile }\n\t\t\t\t\t\tclassName=\"inline-flex cursor-pointer bg-transparent border-0 p-1 my-0 ml-auto mr-0 ring-0 focus:outline-none self-start\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Trash className=\"size-4 text-support-error\" />\n\t\t\t\t\t</button>\n\t\t\t\t) }\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\n// Dropzone Component with embedded FilePreview subcomponent\nexport const Dropzone = ( {\n\tonFileUpload,\n\tinlineIcon = false,\n\tlabel = 'Drag and drop or browse files',\n\thelpText = 'Help Text',\n\tsize = 'sm',\n\tdisabled = false,\n\terror = false,\n\terrorText = 'Upload failed, please try again.',\n}: DropzoneProps ) => {\n\tconst [ isLoading, setIsLoading ] = useState( false );\n\tconst [ file, setFile ] = useState<File | null>( null );\n\tconst [ isDragging, setIsDragging ] = useState( false );\n\n\tconst handleDrop = ( e: React.DragEvent<HTMLDivElement> ) => {\n\t\tif ( disabled ) {\n\t\t\treturn;\n\t\t}\n\t\tsetIsLoading( true );\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tsetIsDragging( false );\n\t\tconst droppedFile = e.dataTransfer.files[ 0 ];\n\t\tif ( droppedFile ) {\n\t\t\tsetFile( droppedFile );\n\t\t\tif ( onFileUpload ) {\n\t\t\t\tonFileUpload( droppedFile );\n\t\t\t}\n\t\t}\n\t\tsetIsLoading( false );\n\t};\n\n\tconst handleDragOver = ( e: React.DragEvent<HTMLDivElement> ) => {\n\t\tif ( disabled ) {\n\t\t\treturn;\n\t\t}\n\t\te.preventDefault();\n\t\tsetIsDragging( true );\n\t};\n\n\tconst handleDragLeave = () => {\n\t\tif ( ! disabled ) {\n\t\t\tsetIsDragging( false );\n\t\t}\n\t};\n\n\tconst handleFileChange = ( e: React.ChangeEvent<HTMLInputElement> ) => {\n\t\tif ( disabled ) {\n\t\t\treturn;\n\t\t}\n\t\tsetIsLoading( true );\n\t\tconst files = e.target.files;\n\t\tif ( ! files ) {\n\t\t\treturn;\n\t\t}\n\t\tconst selectedFile = files[ 0 ];\n\t\tif ( selectedFile ) {\n\t\t\tsetFile( selectedFile );\n\t\t\tif ( onFileUpload ) {\n\t\t\t\tonFileUpload( selectedFile );\n\t\t\t}\n\t\t}\n\t\tsetIsLoading( false );\n\t};\n\n\tconst removeFile = () => {\n\t\tsetFile( null );\n\t};\n\tconst sizeClasses = {\n\t\tsm: {\n\t\t\tlabel: 'text-sm',\n\t\t\thelpText: 'text-xs',\n\t\t\ticon: 'size-5',\n\t\t\tpadding: inlineIcon ? 'p-3' : 'p-5',\n\t\t\tgap: 'gap-2.5',\n\t\t},\n\t\tmd: {\n\t\t\tlabel: 'text-sm',\n\t\t\thelpText: 'text-xs',\n\t\t\ticon: 'size-5',\n\t\t\tpadding: inlineIcon ? 'p-4' : 'p-6',\n\t\t\tgap: 'gap-3',\n\t\t},\n\t\tlg: {\n\t\t\tlabel: 'text-base',\n\t\t\thelpText: 'text-sm',\n\t\t\ticon: 'size-6',\n\t\t\tpadding: inlineIcon ? 'p-4' : 'p-6',\n\t\t\tgap: 'gap-3',\n\t\t},\n\t};\n\tconst uploadInputID = useRef( `fui-file-upload-${ nanoid() }` );\n\treturn (\n\t\t<FileUploadContext.Provider\n\t\t\tvalue={ { file, removeFile, isLoading, error, errorText } }\n\t\t>\n\t\t\t<div>\n\t\t\t\t<label htmlFor={ uploadInputID.current }>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t'min-w-80 cursor-pointer mx-auto border-dashed border rounded-md text-center hover:border-field-dropzone-color hover:bg-field-dropzone-background-hover focus:outline-none focus:ring focus:ring-toggle-on focus:ring-offset-2 transition duration-200 ease-in-out',\n\t\t\t\t\t\t\tisDragging\n\t\t\t\t\t\t\t\t? 'border-field-dropzone-color bg-field-dropzone-background-hover'\n\t\t\t\t\t\t\t\t: 'border-field-border',\n\t\t\t\t\t\t\tdisabled &&\n\t\t\t\t\t\t\t\t'border-field-border bg-field-background-disabled cursor-not-allowed hover:border-field-border',\n\t\t\t\t\t\t\tsizeClasses[ size ].padding\n\t\t\t\t\t\t) }\n\t\t\t\t\t\tonDragOver={ handleDragOver }\n\t\t\t\t\t\tonDragLeave={ handleDragLeave }\n\t\t\t\t\t\tonDrop={ handleDrop }\n\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t\t'flex flex-col items-center justify-center',\n\t\t\t\t\t\t\t\tinlineIcon &&\n\t\t\t\t\t\t\t\t\t`flex-row items-start ${ sizeClasses[ size ].gap }`\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<CloudUpload\n\t\t\t\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t\t\t\t'text-field-dropzone-color size-6',\n\t\t\t\t\t\t\t\t\t\tsizeClasses[ size ].icon,\n\t\t\t\t\t\t\t\t\t\tdisabled && 'text-field-color-disabled'\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"flex flex-col\">\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t\t\t\t'mt-1 text-center font-medium text-field-label',\n\t\t\t\t\t\t\t\t\t\tinlineIcon && 'text-left mt-0',\n\t\t\t\t\t\t\t\t\t\tsizeClasses[ size ].label,\n\t\t\t\t\t\t\t\t\t\tdisabled && 'text-field-color-disabled'\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{ label }\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t{ helpText && (\n\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t\t\t\t\t'mt-1 text-center font-medium text-field-helper',\n\t\t\t\t\t\t\t\t\t\t\tinlineIcon && 'text-left',\n\t\t\t\t\t\t\t\t\t\t\tsizeClasses[ size ].helpText,\n\t\t\t\t\t\t\t\t\t\t\tdisabled &&\n\t\t\t\t\t\t\t\t\t\t\t\t'text-field-color-disabled'\n\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{ helpText }\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tid={ uploadInputID.current }\n\t\t\t\t\t\t\ttype=\"file\"\n\t\t\t\t\t\t\tclassName=\"sr-only\"\n\t\t\t\t\t\t\tonChange={ handleFileChange }\n\t\t\t\t\t\t\tdisabled={ disabled }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</label>\n\n\t\t\t\t<FilePreview />\n\t\t\t</div>\n\t\t</FileUploadContext.Provider>\n\t);\n};\nDropzone.displayName = 'Dropzone';\n\nexport default Dropzone;\n"],"names":["FileUploadContext","createContext","useFileUploadContext","useContext","FilePreview","file","removeFile","isLoading","error","errorText","renderFileIcon","useMemo","jsx","File","cn","jsxs","ImageOff","formatFileSize","Loader","Trash","Dropzone","onFileUpload","inlineIcon","label","helpText","size","disabled","setIsLoading","useState","setFile","isDragging","setIsDragging","handleDrop","e","droppedFile","handleDragOver","handleDragLeave","handleFileChange","files","selectedFile","sizeClasses","uploadInputID","useRef","nanoid","CloudUpload"],"mappings":"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"}