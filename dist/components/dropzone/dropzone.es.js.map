{"version":3,"file":"dropzone.es.js","sources":["../../../src/components/dropzone/dropzone.tsx"],"sourcesContent":["import { useState, createContext, useContext, useRef, useMemo } from 'react';\nimport { CloudUpload, File, ImageOff, Trash } from 'lucide-react';\nimport { cn, formatFileSize } from '@/utilities/functions';\nimport Loader from '@/components/loader';\nimport { nanoid } from 'nanoid';\n\nexport interface DropzoneProps {\n\t/** Callback function when a file is uploaded */\n\tonFileUpload?: ( file: File ) => void;\n\t/** Determines if the icon should be inline */\n\tinlineIcon?: boolean;\n\t/** Label for the dropzone */\n\tlabel?: string;\n\t/** Help text for the dropzone */\n\thelpText?: string;\n\t/** Size variant of the dropzone */\n\tsize?: 'sm' | 'md' | 'lg';\n\t/** Indicates if the component is disabled */\n\tdisabled?: boolean;\n\t/** Indicates if the component is in error state */\n\terror?: boolean;\n\t/** Error text to display */\n\terrorText?: string;\n\t/** Custom class name for the dropzone */\n\tclassName?: string;\n\t/** Custom class name for the wrapper */\n\twrapperClassName?: string;\n}\n\n// Context interface for file data sharing\nexport interface FileUploadContextType {\n\tfile: File | null;\n\tremoveFile: () => void;\n\tisLoading: boolean;\n\terror: boolean;\n\terrorText?: string;\n}\n\n// Create a context to share file data between Dropzone and FilePreview\nconst FileUploadContext = createContext<FileUploadContextType | null>( null );\n\nconst useFileUploadContext = () => useContext( FileUploadContext );\n\n// FilePreview\nexport const FilePreview = () => {\n\tconst { file, removeFile, isLoading, error, errorText } =\n\t\tuseFileUploadContext()!;\n\n\tconst renderFileIcon = useMemo( () => {\n\t\treturn (\n\t\t\t<span className=\"inline-flex self-start p-0.5\">\n\t\t\t\t<File className=\"size-5 text-icon-primary\" />\n\t\t\t</span>\n\t\t);\n\t}, [ file ] );\n\n\tif ( ! file ) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<div\n\t\t\tclassName={ cn(\n\t\t\t\t'border border-solid border-transparent flex items-start justify-between rounded mt-2 bg-field-primary-background p-3 gap-3',\n\t\t\t\terror && 'border-alert-border-danger bg-alert-background-danger'\n\t\t\t) }\n\t\t>\n\t\t\t<div className=\"flex items-center gap-3 w-full\">\n\t\t\t\t{ isLoading && renderFileIcon }\n\t\t\t\t{ ! isLoading &&\n\t\t\t\t\t( file.type.startsWith( 'image/' ) ? (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t\t'size-10 rounded-sm flex items-center justify-center shrink-0',\n\t\t\t\t\t\t\t\terror && 'bg-gray-200 '\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ error ? (\n\t\t\t\t\t\t\t\t<ImageOff className=\"size-6 text-field-helper\" />\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\tsrc={ URL.createObjectURL( file ) }\n\t\t\t\t\t\t\t\t\talt=\"Preview\"\n\t\t\t\t\t\t\t\t\tclassName=\"w-full h-10 object-contain\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) : (\n\t\t\t\t\t\trenderFileIcon\n\t\t\t\t\t) ) }\n\n\t\t\t\t<div className=\"text-left flex flex-col gap-1 w-[calc(100%_-_5.5rem)]\">\n\t\t\t\t\t<span className=\"text-sm font-medium text-field-label truncate\">\n\t\t\t\t\t\t{ isLoading ? 'Loading...' : file.name }\n\t\t\t\t\t</span>\n\t\t\t\t\t{ ! isLoading && (\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t\t'text-xs text-field-helper',\n\t\t\t\t\t\t\t\terror && 'text-support-error'\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ error ? errorText : formatFileSize( file.size ) }\n\t\t\t\t\t\t</span>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t\t{ isLoading ? (\n\t\t\t\t\t<span className=\"inline-flex ml-auto p-0.5\">\n\t\t\t\t\t\t<Loader className=\"inline-flex\" />\n\t\t\t\t\t</span>\n\t\t\t\t) : (\n\t\t\t\t\t<button\n\t\t\t\t\t\tonClick={ removeFile }\n\t\t\t\t\t\tclassName=\"inline-flex cursor-pointer bg-transparent border-0 p-1 my-0 ml-auto mr-0 ring-0 focus:outline-none self-start\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Trash className=\"size-4 text-support-error\" />\n\t\t\t\t\t</button>\n\t\t\t\t) }\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\n// Dropzone Component with embedded FilePreview subcomponent\nexport const Dropzone = ( {\n\tonFileUpload,\n\tinlineIcon = false,\n\tlabel = 'Drag and drop or browse files',\n\thelpText = 'Help Text',\n\tsize = 'sm',\n\tdisabled = false,\n\terror = false,\n\terrorText = 'Upload failed, please try again.',\n\tclassName = '',\n\twrapperClassName = '',\n}: DropzoneProps ) => {\n\tconst [ isLoading, setIsLoading ] = useState( false );\n\tconst [ file, setFile ] = useState<File | null>( null );\n\tconst [ isDragging, setIsDragging ] = useState( false );\n\n\tconst handleDrop = ( e: React.DragEvent<HTMLDivElement> ) => {\n\t\tif ( disabled ) {\n\t\t\treturn;\n\t\t}\n\t\tsetIsLoading( true );\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tsetIsDragging( false );\n\t\tconst droppedFile = e.dataTransfer.files[ 0 ];\n\t\tif ( droppedFile ) {\n\t\t\tsetFile( droppedFile );\n\t\t\tif ( onFileUpload ) {\n\t\t\t\tonFileUpload( droppedFile );\n\t\t\t}\n\t\t}\n\t\tsetIsLoading( false );\n\t};\n\n\tconst handleDragOver = ( e: React.DragEvent<HTMLDivElement> ) => {\n\t\tif ( disabled ) {\n\t\t\treturn;\n\t\t}\n\t\te.preventDefault();\n\t\tsetIsDragging( true );\n\t};\n\n\tconst handleDragLeave = () => {\n\t\tif ( ! disabled ) {\n\t\t\tsetIsDragging( false );\n\t\t}\n\t};\n\n\tconst handleFileChange = ( e: React.ChangeEvent<HTMLInputElement> ) => {\n\t\tif ( disabled ) {\n\t\t\treturn;\n\t\t}\n\t\tsetIsLoading( true );\n\t\tconst files = e.target.files;\n\t\tif ( ! files ) {\n\t\t\treturn;\n\t\t}\n\t\tconst selectedFile = files[ 0 ];\n\t\tif ( selectedFile ) {\n\t\t\tsetFile( selectedFile );\n\t\t\tif ( onFileUpload ) {\n\t\t\t\tonFileUpload( selectedFile );\n\t\t\t}\n\t\t}\n\t\tsetIsLoading( false );\n\t};\n\n\tconst removeFile = () => {\n\t\tsetFile( null );\n\t};\n\tconst sizeClasses = {\n\t\tsm: {\n\t\t\tlabel: 'text-sm',\n\t\t\thelpText: 'text-xs',\n\t\t\ticon: 'size-5',\n\t\t\tpadding: inlineIcon ? 'p-3' : 'p-5',\n\t\t\tgap: 'gap-2.5',\n\t\t},\n\t\tmd: {\n\t\t\tlabel: 'text-sm',\n\t\t\thelpText: 'text-xs',\n\t\t\ticon: 'size-5',\n\t\t\tpadding: inlineIcon ? 'p-4' : 'p-6',\n\t\t\tgap: 'gap-3',\n\t\t},\n\t\tlg: {\n\t\t\tlabel: 'text-base',\n\t\t\thelpText: 'text-sm',\n\t\t\ticon: 'size-6',\n\t\t\tpadding: inlineIcon ? 'p-4' : 'p-6',\n\t\t\tgap: 'gap-3',\n\t\t},\n\t};\n\tconst uploadInputID = useRef( `fui-file-upload-${ nanoid() }` );\n\treturn (\n\t\t<FileUploadContext.Provider\n\t\t\tvalue={ { file, removeFile, isLoading, error, errorText } }\n\t\t>\n\t\t\t<div className={ cn( wrapperClassName ) }>\n\t\t\t\t<label htmlFor={ uploadInputID.current }>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t'min-w-80 cursor-pointer mx-auto border-dashed border rounded-md text-center hover:border-field-dropzone-color hover:bg-field-dropzone-background-hover focus:outline-none focus:ring focus:ring-toggle-on focus:ring-offset-2 transition duration-200 ease-in-out',\n\t\t\t\t\t\t\tisDragging\n\t\t\t\t\t\t\t\t? 'border-field-dropzone-color bg-field-dropzone-background-hover'\n\t\t\t\t\t\t\t\t: 'border-field-border',\n\t\t\t\t\t\t\tdisabled &&\n\t\t\t\t\t\t\t\t'border-field-border bg-field-background-disabled cursor-not-allowed hover:border-field-border',\n\t\t\t\t\t\t\tsizeClasses[ size ].padding,\n\t\t\t\t\t\t\tclassName\n\t\t\t\t\t\t) }\n\t\t\t\t\t\tonDragOver={ handleDragOver }\n\t\t\t\t\t\tonDragLeave={ handleDragLeave }\n\t\t\t\t\t\tonDrop={ handleDrop }\n\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t\t'flex flex-col items-center justify-center',\n\t\t\t\t\t\t\t\tinlineIcon &&\n\t\t\t\t\t\t\t\t\t`flex-row items-start ${ sizeClasses[ size ].gap }`\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<CloudUpload\n\t\t\t\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t\t\t\t'text-field-dropzone-color size-6',\n\t\t\t\t\t\t\t\t\t\tsizeClasses[ size ].icon,\n\t\t\t\t\t\t\t\t\t\tdisabled && 'text-field-color-disabled'\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"flex flex-col\">\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t\t\t\t'mt-1 text-center font-medium text-field-label',\n\t\t\t\t\t\t\t\t\t\tinlineIcon && 'text-left mt-0',\n\t\t\t\t\t\t\t\t\t\tsizeClasses[ size ].label,\n\t\t\t\t\t\t\t\t\t\tdisabled && 'text-field-color-disabled'\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{ label }\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t{ helpText && (\n\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\tclassName={ cn(\n\t\t\t\t\t\t\t\t\t\t\t'mt-1 text-center font-medium text-field-helper',\n\t\t\t\t\t\t\t\t\t\t\tinlineIcon && 'text-left',\n\t\t\t\t\t\t\t\t\t\t\tsizeClasses[ size ].helpText,\n\t\t\t\t\t\t\t\t\t\t\tdisabled &&\n\t\t\t\t\t\t\t\t\t\t\t\t'text-field-color-disabled'\n\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{ helpText }\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tid={ uploadInputID.current }\n\t\t\t\t\t\t\ttype=\"file\"\n\t\t\t\t\t\t\tclassName=\"sr-only\"\n\t\t\t\t\t\t\tonChange={ handleFileChange }\n\t\t\t\t\t\t\tdisabled={ disabled }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</label>\n\n\t\t\t\t<FilePreview />\n\t\t\t</div>\n\t\t</FileUploadContext.Provider>\n\t);\n};\nDropzone.displayName = 'Dropzone';\n\nexport default Dropzone;\n"],"names":["FileUploadContext","createContext","useFileUploadContext","useContext","FilePreview","file","removeFile","isLoading","error","errorText","renderFileIcon","useMemo","jsx","File","cn","jsxs","ImageOff","formatFileSize","Loader","Trash","Dropzone","onFileUpload","inlineIcon","label","helpText","size","disabled","className","wrapperClassName","setIsLoading","useState","setFile","isDragging","setIsDragging","handleDrop","e","droppedFile","handleDragOver","handleDragLeave","handleFileChange","files","selectedFile","sizeClasses","uploadInputID","useRef","nanoid","CloudUpload"],"mappings":";;;;;;AAuCA,MAAMA,IAAoBC,EAA6C,IAAK,GAEtEC,IAAuB,MAAMC,EAAYH,CAAkB,GAGpDI,IAAc,MAAM;AAChC,QAAM,EAAE,MAAAC,GAAM,YAAAC,GAAY,WAAAC,GAAW,OAAAC,GAAO,WAAAC,MAC3CP,EAAqB,GAEhBQ,IAAiBC,EAAS,MAE9B,gBAAAC,EAAC,UAAK,WAAU,gCACf,4BAACC,GAAK,EAAA,WAAU,4BAA2B,EAC5C,CAAA,GAEC,CAAER,CAAK,CAAE;AAEZ,SAAOA,IAKN,gBAAAO;AAAA,IAAC;AAAA,IAAA;AAAA,MACA,WAAYE;AAAA,QACX;AAAA,QACAN,KAAS;AAAA,MACV;AAAA,MAEA,UAAA,gBAAAO,EAAC,OAAI,EAAA,WAAU,kCACZ,UAAA;AAAA,QAAaR,KAAAG;AAAA,QACb,CAAEH,MACDF,EAAK,KAAK,WAAY,QAAS,IAChC,gBAAAO;AAAA,UAAC;AAAA,UAAA;AAAA,YACA,WAAYE;AAAA,cACX;AAAA,cACAN,KAAS;AAAA,YACV;AAAA,YAEE,UACDA,IAAA,gBAAAI,EAACI,GAAS,EAAA,WAAU,2BAA2B,CAAA,IAE/C,gBAAAJ;AAAA,cAAC;AAAA,cAAA;AAAA,gBACA,KAAM,IAAI,gBAAiBP,CAAK;AAAA,gBAChC,KAAI;AAAA,gBACJ,WAAU;AAAA,cAAA;AAAA,YAAA;AAAA,UACX;AAAA,QAIF,IAAAK;AAAA,QAGF,gBAAAK,EAAC,OAAI,EAAA,WAAU,yDACd,UAAA;AAAA,UAAA,gBAAAH,EAAC,UAAK,WAAU,iDACb,UAAYL,IAAA,eAAeF,EAAK,MACnC;AAAA,UACE,CAAEE,KACH,gBAAAK;AAAA,YAAC;AAAA,YAAA;AAAA,cACA,WAAYE;AAAA,gBACX;AAAA,gBACAN,KAAS;AAAA,cACV;AAAA,cAEE,UAAQA,IAAAC,IAAYQ,EAAgBZ,EAAK,IAAK;AAAA,YAAA;AAAA,UAAA;AAAA,QACjD,GAEF;AAAA,QACEE,IACA,gBAAAK,EAAA,QAAA,EAAK,WAAU,6BACf,4BAACM,GAAO,EAAA,WAAU,cAAc,CAAA,EAAA,CACjC,IAEA,gBAAAN;AAAA,UAAC;AAAA,UAAA;AAAA,YACA,SAAUN;AAAA,YACV,WAAU;AAAA,YAEV,UAAA,gBAAAM,EAACO,GAAM,EAAA,WAAU,4BAA4B,CAAA;AAAA,UAAA;AAAA,QAAA;AAAA,MAC9C,EAEF,CAAA;AAAA,IAAA;AAAA,EACD,IA9DO;AAgET,GAGaC,IAAW,CAAE;AAAA,EACzB,cAAAC;AAAA,EACA,YAAAC,IAAa;AAAA,EACb,OAAAC,IAAQ;AAAA,EACR,UAAAC,IAAW;AAAA,EACX,MAAAC,IAAO;AAAA,EACP,UAAAC,IAAW;AAAA,EACX,OAAAlB,IAAQ;AAAA,EACR,WAAAC,IAAY;AAAA,EACZ,WAAAkB,IAAY;AAAA,EACZ,kBAAAC,IAAmB;AACpB,MAAsB;AACrB,QAAM,CAAErB,GAAWsB,CAAa,IAAIC,EAAU,EAAM,GAC9C,CAAEzB,GAAM0B,CAAQ,IAAID,EAAuB,IAAK,GAChD,CAAEE,GAAYC,CAAc,IAAIH,EAAU,EAAM,GAEhDI,IAAa,CAAEC,MAAwC;AAC5D,QAAKT;AACJ;AAED,IAAAG,EAAc,EAAK,GACnBM,EAAE,eAAe,GACjBA,EAAE,gBAAgB,GAClBF,EAAe,EAAM;AACrB,UAAMG,IAAcD,EAAE,aAAa,MAAO,CAAE;AAC5C,IAAKC,MACJL,EAASK,CAAY,GAChBf,KACJA,EAAce,CAAY,IAG5BP,EAAc,EAAM;AAAA,EACrB,GAEMQ,IAAiB,CAAEF,MAAwC;AAChE,IAAKT,MAGLS,EAAE,eAAe,GACjBF,EAAe,EAAK;AAAA,EACrB,GAEMK,IAAkB,MAAM;AAC7B,IAAOZ,KACNO,EAAe,EAAM;AAAA,EAEvB,GAEMM,IAAmB,CAAEJ,MAA4C;AACtE,QAAKT;AACJ;AAED,IAAAG,EAAc,EAAK;AACb,UAAAW,IAAQL,EAAE,OAAO;AACvB,QAAK,CAAEK;AACN;AAEK,UAAAC,IAAeD,EAAO,CAAE;AAC9B,IAAKC,MACJV,EAASU,CAAa,GACjBpB,KACJA,EAAcoB,CAAa,IAG7BZ,EAAc,EAAM;AAAA,EACrB,GAEMvB,IAAa,MAAM;AACxB,IAAAyB,EAAS,IAAK;AAAA,EACf,GACMW,IAAc;AAAA,IACnB,IAAI;AAAA,MACH,OAAO;AAAA,MACP,UAAU;AAAA,MACV,MAAM;AAAA,MACN,SAASpB,IAAa,QAAQ;AAAA,MAC9B,KAAK;AAAA,IACN;AAAA,IACA,IAAI;AAAA,MACH,OAAO;AAAA,MACP,UAAU;AAAA,MACV,MAAM;AAAA,MACN,SAASA,IAAa,QAAQ;AAAA,MAC9B,KAAK;AAAA,IACN;AAAA,IACA,IAAI;AAAA,MACH,OAAO;AAAA,MACP,UAAU;AAAA,MACV,MAAM;AAAA,MACN,SAASA,IAAa,QAAQ;AAAA,MAC9B,KAAK;AAAA,IAAA;AAAA,EAEP,GACMqB,IAAgBC,EAAQ,mBAAoBC,EAAA,CAAS,EAAG;AAE7D,SAAA,gBAAAjC;AAAA,IAACZ,EAAkB;AAAA,IAAlB;AAAA,MACA,OAAQ,EAAE,MAAAK,GAAM,YAAAC,GAAY,WAAAC,GAAW,OAAAC,GAAO,WAAAC,EAAU;AAAA,MAExD,UAAC,gBAAAM,EAAA,OAAA,EAAI,WAAYD,EAAIc,CAAiB,GACrC,UAAA;AAAA,QAAC,gBAAAhB,EAAA,SAAA,EAAM,SAAU+B,EAAc,SAC9B,UAAA,gBAAA5B;AAAA,UAAC;AAAA,UAAA;AAAA,YACA,WAAYD;AAAA,cACX;AAAA,cACAkB,IACG,mEACA;AAAA,cACHN,KACC;AAAA,cACDgB,EAAajB,CAAK,EAAE;AAAA,cACpBE;AAAA,YACD;AAAA,YACA,YAAaU;AAAA,YACb,aAAcC;AAAA,YACd,QAASJ;AAAA,YAET,UAAA;AAAA,cAAA,gBAAAnB;AAAA,gBAAC;AAAA,gBAAA;AAAA,kBACA,WAAYD;AAAA,oBACX;AAAA,oBACAQ,KACC,wBAAyBoB,EAAajB,CAAK,EAAE,GAAI;AAAA,kBACnD;AAAA,kBAEA,UAAA;AAAA,oBAAA,gBAAAb,EAAC,OACA,EAAA,UAAA,gBAAAA;AAAA,sBAACkC;AAAA,sBAAA;AAAA,wBACA,WAAYhC;AAAA,0BACX;AAAA,0BACA4B,EAAajB,CAAK,EAAE;AAAA,0BACpBC,KAAY;AAAA,wBAAA;AAAA,sBACb;AAAA,oBAAA,GAEF;AAAA,oBACA,gBAAAX,EAAC,OAAI,EAAA,WAAU,iBACd,UAAA;AAAA,sBAAA,gBAAAH;AAAA,wBAAC;AAAA,wBAAA;AAAA,0BACA,WAAYE;AAAA,4BACX;AAAA,4BACAQ,KAAc;AAAA,4BACdoB,EAAajB,CAAK,EAAE;AAAA,4BACpBC,KAAY;AAAA,0BACb;AAAA,0BAEE,UAAAH;AAAA,wBAAA;AAAA,sBACH;AAAA,sBACEC,KACD,gBAAAZ;AAAA,wBAAC;AAAA,wBAAA;AAAA,0BACA,WAAYE;AAAA,4BACX;AAAA,4BACAQ,KAAc;AAAA,4BACdoB,EAAajB,CAAK,EAAE;AAAA,4BACpBC,KACC;AAAA,0BACF;AAAA,0BAEE,UAAAF;AAAA,wBAAA;AAAA,sBAAA;AAAA,oBACH,EAEF,CAAA;AAAA,kBAAA;AAAA,gBAAA;AAAA,cACD;AAAA,cACA,gBAAAZ;AAAA,gBAAC;AAAA,gBAAA;AAAA,kBACA,IAAK+B,EAAc;AAAA,kBACnB,MAAK;AAAA,kBACL,WAAU;AAAA,kBACV,UAAWJ;AAAA,kBACX,UAAAb;AAAA,gBAAA;AAAA,cAAA;AAAA,YACD;AAAA,UAAA;AAAA,QAAA,GAEF;AAAA,0BAECtB,GAAY,CAAA,CAAA;AAAA,MAAA,EACd,CAAA;AAAA,IAAA;AAAA,EACD;AAEF;AACAgB,EAAS,cAAc;"}