"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("react/jsx-runtime"),n=require("react"),Q=require("lodash"),c=require("../../utilities/functions.cjs.js"),X=require("lucide-react"),i=require("./styles.cjs.js"),u=require("@floating-ui/react"),Y=require("../badge/badge.cjs.js"),Z=require("../loader/loader.cjs.js"),U=n.createContext({}),j=()=>n.useContext(U),m=n.forwardRef(({className:r,size:s="sm",open:t=!1,setOpen:a,onOpenChange:p,loading:f=!1,clearAfterSelect:d=!0,closeAfterSelect:o=!0,variant:x="primary",filter:y=!0,...B},L)=>{const[E,v]=n.useState(""),[R,h]=n.useState(f??!1),[S,b]=n.useState(null),w=n.useRef([]),I=n.useMemo(()=>typeof a=="function"?a:p,[a,p]),{refs:N,floatingStyles:g,context:l}=u.useFloating({open:t,onOpenChange:I,placement:"bottom-start",whileElementsMounted:u.autoUpdate,middleware:[u.offset(2),u.flip({padding:10}),u.size({apply({rects:M,elements:C,availableHeight:z}){C.floating.style.maxHeight=`${z}px`,C.floating.style.width=`${M.reference.width}px`,C.floating.style.fontFamily=window.getComputedStyle(C.reference).fontFamily}})]}),F=u.useListNavigation(l,{listRef:w,activeIndex:S,onNavigate:b,loop:!0,openOnArrowKeyDown:!1}),H=u.useDismiss(l),{getReferenceProps:$,getFloatingProps:W,getItemProps:_}=u.useInteractions([H,F]);return n.useEffect(()=>{const M=c.getOperatingSystem(),C=z=>{const J=M==="Mac OS"?z.metaKey:z.ctrlKey;if(z.key==="/"&&J&&(z.preventDefault(),N.reference&&N.reference.current)){const G=N.reference.current instanceof HTMLElement?N.reference.current.querySelector("input"):null;G&&G.focus()}};return window.addEventListener("keydown",C),()=>{window.removeEventListener("keydown",C)}},[N.reference]),n.useEffect(()=>{t||b(null)},[t]),e.jsx(U.Provider,{value:{size:s,open:t,onOpenChange:I,refs:N,floatingStyles:g,context:l,getReferenceProps:$,getFloatingProps:W,getItemProps:_,activeIndex:S,setActiveIndex:b,listRef:w,searchTerm:E,setSearchTerm:v,isLoading:R,setIsLoading:h,clearAfterSelect:d,closeAfterSelect:o,variant:x,filter:y},children:e.jsx("div",{className:c.cn("searchbox-wrapper box-border relative w-full",r),...B,ref:L})})});m.displayName="SearchBox";const D=n.forwardRef(({className:r,type:s="text",placeholder:t="Search...",disabled:a=!1,onChange:p=()=>{},...f},d)=>{const{size:o,refs:x,getReferenceProps:y,searchTerm:B,setSearchTerm:L,open:E,setActiveIndex:v,listRef:R,onOpenChange:h,variant:S}=j(),b=o==="lg"?"sm":"xs",w=g=>{const l=g.target.value;L(l),p(l),typeof h=="function"&&(l.trim()?h(!0):h(!1))},I=()=>{a||typeof h!="function"||B?.trim()&&h(!0)},N=g=>{if(!a){if(g.key==="ArrowDown"||g.key==="ArrowUp"){E&&(g.preventDefault(),g.key==="ArrowDown"?v(l=>l===null?0:l):g.key==="ArrowUp"&&v(l=>{const F=R?.current?.length||0;return l===null&&F>0?F-1:l}));return}g.key==="Escape"&&h(!1)}};return e.jsxs("div",{ref:x.setReference,className:c.cn("w-full group relative flex justify-center items-center gap-1.5 focus-within:z-10 transition-all ease-in-out duration-200",i.variantClassNames[S],i.sizeClassNames.input[o],a?i.disabledClassNames[S]:"focus-within:ring-2 focus-within:ring-focus focus-within:ring-offset-2 focus-within:border-focus-border focus-within:hover:border-focus-border",r),...y(),children:[e.jsx("span",{className:c.cn(i.textSizeClassNames[o],a?"text-icon-disabled":i.iconClasses,"flex justify-center items-center"),children:e.jsx(X.Search,{})}),e.jsx("input",{type:s,ref:d,className:c.cn(i.textSizeClassNames[o],"flex-grow font-medium bg-transparent border-none outline-none border-transparent focus:ring-0 p-0 min-h-fit",a&&"text-field-placeholder focus-within:text-field-input group-hover:text-field-input placeholder:text-field-placeholder"),disabled:a,value:B,onChange:w,onFocus:I,onKeyDown:N,placeholder:t,...Q.omit(f,["size","open","onOpenChange","loading"])}),e.jsx(Y.default,{label:c.getOperatingSystem()==="Mac OS"?"âŒ˜/":"Ctrl /",size:b,type:"rounded",variant:"neutral",className:"bg-background-primary"})]})});D.displayName="SearchBox.Input";const O=({className:r,children:s,...t})=>{const{size:a,open:p,refs:f,floatingStyles:d,getFloatingProps:o,context:x}=j();return p?e.jsx(u.FloatingFocusManager,{context:x,initialFocus:-1,returnFocus:!0,children:e.jsx("div",{ref:f.setFloating,style:{...d},className:c.cn("bg-background-primary rounded-md border border-solid border-border-subtle shadow-soft-shadow-lg overflow-y-auto text-wrap focus:outline-none",i.sizeClassNames.dialog[a],r),...o(),...t,children:s})}):null};O.displayName="SearchBox.Content";const T=({children:r,id:s,root:t})=>e.jsx(u.FloatingPortal,{id:s,root:t,children:r});T.displayName="SearchBox.Portal";const K=({children:r,className:s})=>{const{searchTerm:t,isLoading:a,listRef:p,filter:f=!0}=j();if(!f)return e.jsx(u.FloatingList,{elementsRef:p,children:e.jsx("div",{className:s,children:r})});const d=n.Children.toArray(r).map(o=>{if(n.isValidElement(o)&&o.type===P){const x=n.Children.toArray(o.props.children).filter(y=>n.isValidElement(y)&&typeof y.props.children=="string"&&y.props.children.toLowerCase().includes(t.toLowerCase()));return x.length>0?n.cloneElement(o,{children:x}):null}return o}).filter(Boolean);return a?e.jsx(A,{}):e.jsx(u.FloatingList,{elementsRef:p,children:e.jsx("div",{className:s,children:d.some(o=>n.isValidElement(o)&&o.type!==q)?d:e.jsx(k,{})})})};K.displayName="SearchBox.List";const k=({children:r="No results found.",className:s})=>{const{size:t}=j();return e.jsx("div",{className:c.cn("flex justify-center items-center",i.sizeClassNames.item[t],"text-text-tertiary p-4",s),children:r})};k.displayName="SearchBox.Empty";const P=({heading:r,children:s})=>{const{size:t}=j();return e.jsxs("div",{className:c.cn(i.sizeClassNames.content[t],i.sizeClassNames.item[t]),children:[r&&e.jsx("div",{className:c.cn(i.sizeClassNames.title[t],"text-text-tertiary"),children:r}),s]})};P.displayName="SearchBox.Group";const V=n.forwardRef(({className:r,icon:s,children:t,onClick:a,...p},f)=>{const{size:d,setSearchTerm:o,clearAfterSelect:x,getItemProps:y,activeIndex:B,onOpenChange:L,closeAfterSelect:E}=j(),{ref:v,index:R}=u.useListItem(),h=w=>{typeof f=="function"?f(w):f&&(f.current=w),v(w)},S=B===R,b=()=>{typeof a=="function"&&a(),x&&o(""),E&&L(!1)};return e.jsxs("button",{type:"button",ref:h,className:c.cn("flex w-full items-center justify-start gap-1 p-1 cursor-pointer border-none bg-transparent text-left focus:outline-none",S&&"bg-background-secondary",!S&&"hover:bg-background-secondary focus:bg-background-secondary",i.sizeClassNames.item[d],r),...y?.({role:"option","aria-selected":S,onClick:b,...p}),children:[s&&e.jsx("span",{className:c.cn(i.sizeClassNames.icon[d],"flex items-center justify-center"),children:s}),e.jsx("span",{className:c.cn("flex-grow py-0.5 px-1 font-normal",i.sizeClassNames.item[d]),children:t})]})});V.displayName="SearchBox.Item";const A=({loadingIcon:r=e.jsx(Z.Loader,{})})=>{const{size:s}=j(),t=n.isValidElement(r)?n.cloneElement(r,{size:s}):r;return e.jsx("div",{className:c.cn("flex justify-center p-4",i.textSizeClassNames[s],i.sizeClassNames.item[s]),children:t})};A.displayName="SearchBox.Loading";const q=n.forwardRef(({className:r,...s},t)=>e.jsx("hr",{ref:t,className:c.cn("border-0 border-t border-border-subtle border-solid m-0",r),...s}));q.displayName="SearchBox.Separator";m.Input=D;m.Loading=A;m.Separator=q;m.Content=O;m.List=K;m.Empty=k;m.Group=P;m.Item=V;m.Portal=T;exports.SearchBox=m;exports.SearchBoxContent=O;exports.SearchBoxEmpty=k;exports.SearchBoxGroup=P;exports.SearchBoxInput=D;exports.SearchBoxItem=V;exports.SearchBoxList=K;exports.SearchBoxLoading=A;exports.SearchBoxPortal=T;exports.SearchBoxSeparator=q;exports.default=m;
//# sourceMappingURL=search.cjs.js.map
