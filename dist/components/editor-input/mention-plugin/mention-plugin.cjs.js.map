{"version":3,"file":"mention-plugin.cjs.js","sources":["../../../../src/components/editor-input/mention-plugin/mention-plugin.tsx"],"sourcesContent":["import React, {\n\tuseCallback,\n\tuseState,\n\tuseMemo,\n\tuseEffect,\n\tuseRef,\n} from 'react';\nimport { useLexicalComposerContext } from '@lexical/react/LexicalComposerContext';\nimport {\n\tLexicalTypeaheadMenuPlugin,\n\ttype TypeaheadMenuPluginProps,\n\ttype MenuOption,\n} from '@lexical/react/LexicalTypeaheadMenuPlugin';\nimport { $createMentionNode, $isMentionNode } from './mention-node';\nimport OptionItem from './mention-option-item';\nimport useMentionLookupService from './mention-hooks';\nimport EditorCombobox from './mention-combobox';\nimport {\n\t$createTextNode,\n\t$getSelection,\n\tCOMMAND_PRIORITY_LOW,\n\tKEY_DOWN_COMMAND,\n\tKEY_BACKSPACE_COMMAND,\n\ttype RangeSelection,\n\ttype CommandListener,\n\tFOCUS_COMMAND,\n} from 'lexical';\nimport { mergeRegister } from '@lexical/utils';\nimport { type TOptionItem } from '../editor-input';\nimport {\n\tuseFloating,\n\tautoPlacement,\n\toffset,\n\tflip,\n\tshift,\n\tautoUpdate,\n} from '@floating-ui/react';\n\nexport type Trigger = '@' | '#' | ( string & {} );\nexport type TSizes = 'lg' | 'md' | 'sm';\nexport type OptionsArray = Array<TOptionItem>;\nexport type TMenuComponent = React.ComponentType<\n\tReact.ComponentProps<typeof EditorCombobox>\n>;\nexport type TMenuItemComponent = React.ComponentType<\n\tReact.ComponentProps<typeof EditorCombobox.Item>\n>;\n\nexport interface MentionPluginProps<T = OptionsArray> {\n\toptionsArray: T;\n\tby: T extends Array<infer U>\n\t\t? U extends Record<string, unknown>\n\t\t\t? keyof U\n\t\t\t: string\n\t\t: string;\n\tsize: TSizes;\n\ttrigger: Trigger;\n\tmenuComponent?: TMenuComponent;\n\tmenuItemComponent?: TMenuItemComponent;\n\tautoSpace: boolean;\n}\n\nconst MentionPlugin = ( {\n\toptionsArray,\n\tby = 'name',\n\tsize = 'md',\n\ttrigger = '@', // Default trigger value\n\tmenuComponent: MenuComponent = EditorCombobox,\n\tmenuItemComponent: MenuItemComponent = EditorCombobox.Item,\n\tautoSpace = true,\n}: MentionPluginProps ) => {\n\tconst { y, refs, strategy } = useFloating( {\n\t\tplacement: 'bottom',\n\t\tstrategy: 'absolute',\n\t\tmiddleware: [ offset( 8 ), autoPlacement(), shift(), flip() ],\n\t\twhileElementsMounted: autoUpdate,\n\t} );\n\n\tconst autoSpaceTempOff = useRef( false );\n\tconst menuRef = useRef<HTMLElement | null>( null );\n\t// Define PUNCTUATION and other necessary variables inside the component\n\tconst PUNCTUATION =\n\t\t'\\\\.,\\\\+\\\\*\\\\?\\\\$\\\\@\\\\|#{}\\\\(\\\\)\\\\^\\\\-\\\\[\\\\]\\\\\\\\/!%\\'\"~=<>_:;';\n\n\tconst TRIGGERS = [ trigger ].join( '' ); // Use the trigger prop dynamically\n\n\tconst VALID_CHARS = '[^' + TRIGGERS + PUNCTUATION + '\\\\s]';\n\n\tconst VALID_JOINS =\n\t\t'(?:' +\n\t\t'\\\\.[ |$]|' + // E.g. \"r. \" in \"Mr. Smith\"\n\t\t' |' + // E.g. \" \" in \"Josh Duck\"\n\t\t'[' +\n\t\tPUNCTUATION +\n\t\t']|' + // E.g. \"-' in \"Salier-Hellendag\"\n\t\t')';\n\n\tconst LENGTH_LIMIT = 75;\n\n\tconst AtSignMentionsRegex = new RegExp(\n\t\t`(^|\\\\s|\\\\()([${ TRIGGERS }]((?:${ VALID_CHARS }${ VALID_JOINS }){0,${ LENGTH_LIMIT }}))$`\n\t);\n\n\t// 50 is the longest alias length limit\n\tconst ALIAS_LENGTH_LIMIT = 50;\n\n\t// Regex used to match alias\n\tconst AtSignMentionsRegexAliasRegex = new RegExp(\n\t\t`(^|\\\\s|\\\\()([${ TRIGGERS }]((?:${ VALID_CHARS }){0,${ ALIAS_LENGTH_LIMIT }}))$`\n\t);\n\n\t// Define checkForAtSignMentions function inside the component where it has access to the regex\n\tconst checkForAtSignMentions = ( text: string ) => {\n\t\tlet match = AtSignMentionsRegex.exec( text );\n\n\t\tif ( match === null ) {\n\t\t\tmatch = AtSignMentionsRegexAliasRegex.exec( text );\n\t\t}\n\t\tif ( match !== null ) {\n\t\t\t// The strategy ignores leading whitespace but we need to know its\n\t\t\t// length to add it to the leadOffset\n\t\t\tconst maybeLeadingWhitespace = match[ 1 ];\n\n\t\t\tconst matchingString = match[ 3 ];\n\t\t\tif ( matchingString.length >= 0 ) {\n\t\t\t\treturn {\n\t\t\t\t\tleadOffset: match.index + maybeLeadingWhitespace.length,\n\t\t\t\t\tmatchingString,\n\t\t\t\t\treplaceableString: match[ 2 ],\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\n\tconst [ editor ] = useLexicalComposerContext();\n\tconst [ queryString, setQueryString ] = useState<string | null>( null );\n\tconst [ isMenuOpen, setIsMenuOpen ] = useState<boolean>( false );\n\n\t// Use the hook to get lookup results\n\tconst results = useMentionLookupService( optionsArray, queryString, by );\n\n\tconst onSelectOption = useCallback<\n\t\tTypeaheadMenuPluginProps<\n\t\t\tMenuOption & { data: TOptionItem }\n\t\t>['onSelectOption']\n\t>(\n\t\t( selectedOption, nodeToReplace, closeMenu ) => {\n\t\t\teditor.update( () => {\n\t\t\t\tconst mentionNode = $createMentionNode(\n\t\t\t\t\tselectedOption.data,\n\t\t\t\t\tby as keyof TOptionItem,\n\t\t\t\t\tsize\n\t\t\t\t);\n\t\t\t\tif ( nodeToReplace ) {\n\t\t\t\t\tnodeToReplace.replace( mentionNode );\n\t\t\t\t}\n\t\t\t\tcloseMenu();\n\t\t\t\tsetIsMenuOpen( false );\n\t\t\t} );\n\t\t},\n\t\t[ editor ]\n\t);\n\n\tconst options = useMemo( () => {\n\t\treturn results.map( ( result ) => new OptionItem( result ) );\n\t}, [ editor, results ] );\n\n\tconst handleAutoSpaceAfterMention = useCallback<\n\t\tCommandListener<KeyboardEvent>\n\t>(\n\t\t( event ) => {\n\t\t\tif ( ! autoSpace ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst { key, ctrlKey, metaKey } = event;\n\n\t\t\tif (\n\t\t\t\tctrlKey ||\n\t\t\t\tmetaKey ||\n\t\t\t\tkey === ' ' ||\n\t\t\t\tkey.length > 1 ||\n\t\t\t\tautoSpaceTempOff.current\n\t\t\t) {\n\t\t\t\tif ( autoSpaceTempOff.current ) {\n\t\t\t\t\tautoSpaceTempOff.current = false;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst selection = $getSelection();\n\t\t\tconst { focus, anchor } = selection as RangeSelection;\n\t\t\tconst [ node ] = selection!.getNodes();\n\n\t\t\tif (\n\t\t\t\t! anchor ||\n\t\t\t\t! focus ||\n\t\t\t\tanchor?.key !== focus?.key ||\n\t\t\t\tanchor?.offset !== focus?.offset ||\n\t\t\t\t! node\n\t\t\t) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif ( $isMentionNode( node ) ) {\n\t\t\t\tconst textNode = $createTextNode( ' ' );\n\t\t\t\tnode.insertAfter( textNode );\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\t[ editor, trigger, autoSpace ]\n\t);\n\n\tconst turnOffAutoSpaceIfNecessary = useCallback<\n\t\tCommandListener<KeyboardEvent>\n\t>(\n\t\t( event ) => {\n\t\t\tconst { key } = event;\n\t\t\tif ( key === 'Backspace' ) {\n\t\t\t\tautoSpaceTempOff.current = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\t[ autoSpaceTempOff ]\n\t);\n\n\tconst handleOpen = useCallback( () => {\n\t\tsetIsMenuOpen( true );\n\t}, [] );\n\n\tconst handleFocus = useCallback( () => {\n\t\thandleOpen();\n\t\treturn false;\n\t}, [] );\n\n\tuseEffect( () => {\n\t\tif ( ! editor ) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn mergeRegister(\n\t\t\teditor.registerCommand(\n\t\t\t\tKEY_DOWN_COMMAND,\n\t\t\t\thandleAutoSpaceAfterMention,\n\t\t\t\tCOMMAND_PRIORITY_LOW\n\t\t\t),\n\t\t\teditor.registerCommand(\n\t\t\t\tKEY_BACKSPACE_COMMAND,\n\t\t\t\tturnOffAutoSpaceIfNecessary,\n\t\t\t\tCOMMAND_PRIORITY_LOW\n\t\t\t),\n\t\t\teditor.registerCommand(\n\t\t\t\tFOCUS_COMMAND,\n\t\t\t\thandleFocus,\n\t\t\t\tCOMMAND_PRIORITY_LOW\n\t\t\t)\n\t\t);\n\t}, [ editor, handleAutoSpaceAfterMention ] );\n\n\t// Set the floating reference to the editor input.\n\tuseEffect( () => {\n\t\tif ( ! editor ) {\n\t\t\treturn;\n\t\t}\n\t\tconst reference = editor.getRootElement()?.parentElement?.parentElement;\n\t\tif ( ! reference ) {\n\t\t\treturn;\n\t\t}\n\t\trefs.setReference( reference );\n\t}, [ editor, refs ] );\n\n\t// Update menu open state based on options availability\n\tuseEffect( () => {\n\t\tif ( isMenuOpen ) {\n\t\t\treturn;\n\t\t}\n\t\tsetIsMenuOpen( options.length > 0 );\n\t}, [ options ] );\n\n\t// Handle outside clicks to close the dropdown\n\tuseEffect( () => {\n\t\tif ( ! isMenuOpen ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst handleOutsideClick = ( event: MouseEvent ) => {\n\t\t\tconst target = event.target as Node;\n\t\t\tconst editorRoot = editor.getRootElement();\n\t\t\tconst floatingElement = refs.floating.current;\n\n\t\t\t// Check if click is outside editor and dropdown menu\n\t\t\tif (\n\t\t\t\teditorRoot &&\n\t\t\t\t! editorRoot.contains( target ) &&\n\t\t\t\tfloatingElement &&\n\t\t\t\t! floatingElement.contains( target )\n\t\t\t) {\n\t\t\t\tsetIsMenuOpen( false );\n\t\t\t\tsetQueryString( null );\n\t\t\t}\n\t\t};\n\n\t\t// Handle editor blur\n\t\tconst handleEditorBlur = () => {\n\t\t\t// Small delay to check if focus moved to the dropdown\n\t\t\tsetTimeout( () => {\n\t\t\t\tconst editorRoot = editor.getRootElement();\n\t\t\t\tconst floatingElement = refs.floating.current;\n\n\t\t\t\tif ( editorRoot ) {\n\t\t\t\t\tconst doc = editorRoot.ownerDocument;\n\t\t\t\t\tconst activeElement = doc.activeElement;\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tfloatingElement &&\n\t\t\t\t\t\t( ! activeElement ||\n\t\t\t\t\t\t\t! floatingElement.contains( activeElement ) )\n\t\t\t\t\t) {\n\t\t\t\t\t\tsetIsMenuOpen( false );\n\t\t\t\t\t\tsetQueryString( null );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, 100 );\n\t\t};\n\n\t\t// Add event listeners\n\t\tdocument.addEventListener( 'mousedown', handleOutsideClick );\n\n\t\tconst editorRoot = editor.getRootElement();\n\t\tif ( editorRoot ) {\n\t\t\teditorRoot.addEventListener( 'blur', handleEditorBlur, true );\n\t\t}\n\n\t\t// Cleanup\n\t\treturn () => {\n\t\t\tdocument.removeEventListener( 'mousedown', handleOutsideClick );\n\t\t\tif ( editorRoot ) {\n\t\t\t\teditorRoot.removeEventListener( 'blur', handleEditorBlur, true );\n\t\t\t}\n\t\t};\n\t}, [ isMenuOpen, editor, refs.floating ] );\n\n\treturn (\n\t\t<LexicalTypeaheadMenuPlugin\n\t\t\tonOpen={ handleOpen }\n\t\t\tonQueryChange={ setQueryString }\n\t\t\tonSelectOption={ onSelectOption }\n\t\t\ttriggerFn={ checkForAtSignMentions } // Use the locally defined function\n\t\t\toptions={ options }\n\t\t\tmenuRenderFn={ (\n\t\t\t\tanchorElementRef,\n\t\t\t\t{ selectedIndex, selectOptionAndCleanUp, setHighlightedIndex }\n\t\t\t): React.JSX.Element | null => {\n\t\t\t\tif (\n\t\t\t\t\t! isMenuOpen ||\n\t\t\t\t\t! anchorElementRef.current ||\n\t\t\t\t\t! options?.length\n\t\t\t\t) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn (\n\t\t\t\t\t<MenuComponent\n\t\t\t\t\t\tclassName=\"w-full\"\n\t\t\t\t\t\tsize={ size }\n\t\t\t\t\t\tref={ ( node ) => {\n\t\t\t\t\t\t\trefs.setFloating( node );\n\t\t\t\t\t\t\tmenuRef.current = node;\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tstyle={ {\n\t\t\t\t\t\t\tposition: strategy,\n\t\t\t\t\t\t\ttop: y ?? 0,\n\t\t\t\t\t\t\tleft: -2,\n\t\t\t\t\t\t\twidth: 'calc(100% + 4px)',\n\t\t\t\t\t\t} }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ options.map( ( option, index ) => (\n\t\t\t\t\t\t\t<MenuItemComponent\n\t\t\t\t\t\t\t\tkey={ index }\n\t\t\t\t\t\t\t\tref={ option.ref }\n\t\t\t\t\t\t\t\tsize={ size }\n\t\t\t\t\t\t\t\tselected={ index === selectedIndex }\n\t\t\t\t\t\t\t\tonMouseEnter={ () => {\n\t\t\t\t\t\t\t\t\tsetHighlightedIndex( index );\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\tonClick={ () => selectOptionAndCleanUp( option ) }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ typeof option.data === 'string'\n\t\t\t\t\t\t\t\t\t? option.data\n\t\t\t\t\t\t\t\t\t: ( option.data?.[ by ] as string ) }\n\t\t\t\t\t\t\t</MenuItemComponent>\n\t\t\t\t\t\t) ) }\n\t\t\t\t\t</MenuComponent>\n\t\t\t\t);\n\t\t\t} }\n\t\t/>\n\t);\n};\n\nexport default MentionPlugin;\n"],"names":["MentionPlugin","optionsArray","by","size","trigger","MenuComponent","EditorCombobox","MenuItemComponent","autoSpace","y","refs","strategy","useFloating","offset","autoPlacement","shift","flip","autoUpdate","autoSpaceTempOff","useRef","menuRef","PUNCTUATION","TRIGGERS","VALID_CHARS","VALID_JOINS","LENGTH_LIMIT","AtSignMentionsRegex","ALIAS_LENGTH_LIMIT","AtSignMentionsRegexAliasRegex","checkForAtSignMentions","text","match","maybeLeadingWhitespace","matchingString","editor","useLexicalComposerContext","queryString","setQueryString","useState","isMenuOpen","setIsMenuOpen","results","useMentionLookupService","onSelectOption","useCallback","selectedOption","nodeToReplace","closeMenu","mentionNode","$createMentionNode","options","useMemo","result","OptionItem","handleAutoSpaceAfterMention","event","key","ctrlKey","metaKey","selection","$getSelection","focus","anchor","node","$isMentionNode","textNode","$createTextNode","turnOffAutoSpaceIfNecessary","handleOpen","handleFocus","useEffect","mergeRegister","KEY_DOWN_COMMAND","COMMAND_PRIORITY_LOW","KEY_BACKSPACE_COMMAND","FOCUS_COMMAND","reference","handleOutsideClick","target","editorRoot","floatingElement","handleEditorBlur","activeElement","jsx","LexicalTypeaheadMenuPlugin","anchorElementRef","selectedIndex","selectOptionAndCleanUp","setHighlightedIndex","option","index"],"mappings":"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"}